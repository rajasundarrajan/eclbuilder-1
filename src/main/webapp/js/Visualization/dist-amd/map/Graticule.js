(function(e,t){typeof define=="function"&&define.amd?define(["d3","topojson","./Layer","../common/Palette","../api/ITooltip","css!./Graticule"],t):e.map_Graticule=t(e.d3,e.topojson,e.map_Layer,e.common_Palette,e.api_ITooltip)})(this,function(e,t,n,r,i){function s(){n.call(this),i.call(this),this._dataMap={},this._path=e.select(null)}return s.prototype=Object.create(n.prototype),s.prototype.constructor=s,s.prototype._class+=" map_Graticule",s.prototype.implements(i.prototype),s.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),s.prototype.publish("meshColor",null,"html-color","Stroke Color",null,{optional:!0}),s.prototype.publish("meshStrokeWidth",.25,"number","Stroke Width"),s.prototype.layerEnter=function(t,r,i){n.prototype.layerEnter.apply(this,arguments),this._graticule=e.geo.graticule(),this._graticulePath=r.append("path").datum(this._graticule).attr("class","graticule"),this._graticuleOutlinePath=r.append("path").datum(this._graticule.outline).attr("class","graticuleOutline")},s.prototype.layerUpdate=function(e){if(!this.visible()){this._graticulePath.attr("d",""),this._graticuleOutlinePath.attr("d",""),delete this._prevProjection;return}this._prevProjection!==e.projection()&&(this._graticulePath.attr("d",e._d3GeoPath),this._graticuleOutlinePath.attr("d",e._d3GeoPath),this._prevProjection=e.projection()),this._graticulePath.style("stroke",this.meshColor()),this._graticuleOutlinePath.style("stroke",this.meshColor())},s.prototype.layerExit=function(e){delete this._prevProjection},s.prototype.layerZoomed=function(e){this._graticulePath.style("opacity",this.opacity()).attr("transform","translate("+e._zoom.translate()+")scale("+e._zoom.scale()+")").style("stroke-width",this.meshStrokeWidth()/e._zoom.scale()+"px"),this._graticuleOutlinePath.style("opacity",this.opacity()).attr("transform","translate("+e._zoom.translate()+")scale("+e._zoom.scale()+")").style("stroke-width",this.meshStrokeWidth()/e._zoom.scale()+"px")},s});