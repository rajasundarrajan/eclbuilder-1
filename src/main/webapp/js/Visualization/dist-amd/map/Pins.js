(function(e,t){typeof define=="function"&&define.amd?define(["d3","./Layer","../common/Palette","../common/Utility","css!./Pins"],t):e.map_Pins=t(e.d3,e.map_Layer,e.common_Palette,e.common_Utility)})(this,function(e,t,n,r){function i(){t.call(this)}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" map_Pins",i.prototype.publish("opacity",1,"number","Opacity",null,{tags:["Advanced"]}),i.prototype.publish("fillColor","#006ccc","html-color","Pin Color",null,{optional:!0}),i.prototype.layerEnter=function(n,i,s){t.prototype.layerEnter.apply(this,arguments),this._pinsTransform=i,this._selection=new r.SimpleSelection(this._pinsTransform),this.pinsPaths=e.select(null)},i.prototype.layerUpdate=function(e){t.prototype.layerUpdate.apply(this,arguments),this._pinsTransform.style("opacity",this.opacity()),this.pinsPaths=this._pinsTransform.selectAll(".data").data(this.visible()?this.data():[],function(e){return e[0]});var n=this;this.pinsPaths.enter().append("path").attr("class","data").attr("d",function(e){return"M 0,0 C -2,-20 -10,-22 -10,-30 A 10,10 0 1,1 10,-30 C 10,-22 2,-20 0,0 z M -2,-30"}).call(this._selection.enter.bind(this._selection)).on("click",function(e){n.click(n.rowToObj(e),"weight",n._selection.selected(this))}).append("title"),this.pinsPaths.attr("stroke-width","1.5px").style("display",function(t){var n=e.project(t[0],t[1]);return n?null:"none"}).style("fill",function(e){return e[2]&&e[2].fillColor?e[2].fillColor:n.fillColor()}),this.pinsPaths.select("title").text(function(e){return e[2]&&e[2].tooltip?e[2].tooltip:""}),this.pinsPaths.exit().remove()},i.prototype.layerZoomed=function(e){t.prototype.layerZoomed.apply(this,arguments),this.pinsPaths.attr("transform",function(t){var n=e.project(t[0],t[1]);return n||(n=[0,0]),"translate("+n[0]+", "+n[1]+")scale("+.5+")"})},i.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+", "+n)},i});