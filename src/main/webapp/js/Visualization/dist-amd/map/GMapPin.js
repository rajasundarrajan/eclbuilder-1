(function(e,t){typeof define=="function"&&define.amd?define(["d3","./GMapLayered","./Pins"],t):e.map_GMapPin=t(e.d3,e.map_GMapLayered,e.map_Pins)})(this,function(e,t,n){function r(e){t.call(this);var r=this;this._pins=(new n).columns(["lat","long","ext"]).on("click",function(e,t,n){r.click(r.rowToObj(e.ext.origRow),"",n)})}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" map_GMapPin",r.prototype.publishProxy("pinColor","_pins","fillColor"),r.prototype.publish("latitudeColumn",null,"set","Latitude",function(){return this.columns()},{optional:!0}),r.prototype.publish("longtitudeColumn",null,"set","Longtitude",function(){return this.columns()},{optional:!0}),r.prototype.publish("colorColumn",null,"set","Color",function(){return this.columns()},{optional:!0}),r.prototype.publish("tooltipColumn",null,"set","Tooltip",function(){return this.columns()},{optional:!0}),r.prototype.pinsData=function(){var e=this.columns();return this._view=this._db.rollupView([this.latitudeColumn(),this.longtitudeColumn()]),this._view.entries().map(function(t){var n=t.values[0].values[0];return[t.key,t.values[0].key,{fillColor:n[e.indexOf(this.colorColumn())],tooltip:n[e.indexOf(this.tooltipColumn())],origRow:n}]},this)},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this.layers([this._pins])},r.prototype.update=function(e,n){t.prototype.update.apply(this,arguments),this._pins.data(this.pinsData())},r.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},r.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+","+n)},r});