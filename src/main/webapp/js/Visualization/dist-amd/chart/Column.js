(function(e,t){typeof define=="function"&&define.amd?define(["d3","./XYAxis","../api/INDChart","../api/ITooltip","css!./Column"],t):e.chart_Column=t(e.d3,e.chart_XYAxis,e.api_INDChart,e.api_ITooltip)})(this,function(e,t,n,r){function i(e){t.call(this),n.call(this),r.call(this),this._linearGap=25}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" chart_Column",i.prototype.implements(n.prototype),i.prototype.implements(r.prototype),i.prototype.publish("paletteID","default","set","Palette ID",i.prototype._palette.switch(),{tags:["Basic","Shared"]}),i.prototype.publish("stacked",!1,"boolean","Stacked Bars",null,{tags:["Basic"]}),i.prototype.publish("stackedOpacity",.66,"number","Fill Stacked Opacity",null,{tags:["Basic"]}),i.prototype.publish("useClonedPalette",!1,"boolean","Enable or disable using a cloned palette",null,{tags:["Intermediate","Shared"]}),i.prototype.updateChart=function(t,n,r,i,s,o){var u=this;this._palette=this._palette.switch(this.paletteID()),this.useClonedPalette()&&(this._palette=this._palette.cloneNotExists(this.paletteID()+"_"+this.id()));var a=10,f=0;switch(this.xAxisType()){case"ordinal":a=this.dataScale.rangeBand(),f=0;break;case"linear":case"time":a=Math.max(Math.abs(this.dataScale(2)-this.dataScale(1))*(100-this._linearGap)/100,a),f=-a/2}var l=e.scale.ordinal().domain(u.columns().filter(function(e,t){return t>0})).rangeRoundBands(o?[0,a]:[a,0]),c=this.svgData.selectAll(".dataRow").data(this.formattedData());c.enter().append("g").attr("class","dataRow"),c.each(function(t,n){var r=e.select(this),i=r.selectAll("rect").data(t.filter(function(e,t){return t<u.columns().length}).map(function(e,n){return{column:u.columns()[n],row:t,value:e,idx:n}}).filter(function(e,t){return e.value!==null&&e.idx>0}));i.enter().append("rect").attr("class","columnRect").call(u._selection.enter.bind(u._selection)).on("mouseover.tooltip",function(e){u.tooltipShow(e.row,u.columns(),e.idx)}).on("mouseout.tooltip",function(e){u.tooltipShow()}).on("mousemove.tooltip",function(e){u.tooltipShow(e.row,u.columns(),e.idx)}).on("click",function(e,t){u.click(u.rowToObj(e.row),e.column,u._selection.selected(this))}),o?i.transition().attr("x",function(e){return u.dataScale(t[0])+(u.stacked()?0:l(e.column))+f}).attr("width",u.stacked()?a:l.rangeBand()).attr("y",function(e){return e.value instanceof Array?u.valueScale(e.value[1]):u.valueScale(e.value)}).attr("height",function(e){return e.value instanceof Array?u.valueScale(e.value[0])-u.valueScale(e.value[1]):s-u.valueScale(e.value)}).style("opacity",u.stacked()?u.stackedOpacity():1).style("fill",function(e){return u._palette(e.column)}):i.transition().attr("y",function(e){return u.dataScale(t[0])+(u.stacked()?0:l(e.column))+f}).attr("height",u.stacked()?a:l.rangeBand()).attr("x",function(e){return e.value instanceof Array?u.valueScale(e.value[0]):0}).attr("width",function(e){return e.value instanceof Array?u.valueScale(e.value[1])-u.valueScale(e.value[0]):u.valueScale(e.value)}).style("opacity",u.stacked()?u.stackedOpacity():1).style("fill",function(e){return u._palette(e.column)}),u.stacked()&&i.sort(function(e,t){return t-e}),i.exit().transition().remove()}),c.exit().transition().remove()},i});