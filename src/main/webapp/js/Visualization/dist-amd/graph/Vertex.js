(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/SVGWidget","../common/Icon","../common/TextBox","css!./Vertex"],t):e.graph_Vertex=t(e.d3,e.common_SVGWidget,e.common_Icon,e.common_TextBox)})(this,function(e,t,n,r){function i(){t.call(this),this._icon=new n,this._textBox=new r,this._annotationWidgets={}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" graph_Vertex",i.prototype.publishProxy("faChar","_icon"),i.prototype.publishProxy("icon_shape_diameter","_icon","diameter"),i.prototype.publishProxy("icon_shape_colorFill","_icon","shape_colorFill"),i.prototype.publishProxy("icon_shape_colorStroke","_icon","shape_colorStroke"),i.prototype.publishProxy("icon_image_colorFill","_icon","image_colorFill"),i.prototype.publishProxy("text","_textBox"),i.prototype.publishProxy("anchor","_textBox"),i.prototype.publishProxy("textbox_shape_colorStroke","_textBox","shape_colorStroke"),i.prototype.publishProxy("textbox_shape_colorFill","_textBox","shape_colorFill"),i.prototype.publishProxy("textbox_text_colorFill","_textBox","text_colorFill"),i.prototype.publish("iconAnchor","start","set","Icon Anchor Position",["","start","middle","end"],{tags:["Basic"]}),i.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),i.prototype.publish("annotationDiameter",14,"number","Annotation Diameter",null,{tags:["Private"]}),i.prototype.publish("annotationSpacing",3,"number","Annotation Spacing",null,{tags:["Private"]}),i.prototype.publish("annotationIcons",[],"array","Annotations",null,{tags:["Private"]}),i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._icon.target(e).render(),this._textBox.target(e).render()},i.prototype.update=function(r,i){t.prototype.update.apply(this,arguments),this._icon.tooltip(this.tooltip()).render();var s=this._icon.getBBox(!0);this._textBox.tooltip(this.tooltip()).render();var o=this._textBox.getBBox(!0);switch(this.iconAnchor()){case"start":this._icon.move({x:-(o.width/2)+s.width/3,y:-(o.height/2)-s.height/3});break;case"middle":this._icon.move({x:0,y:-(o.height/2)-s.height/3});break;case"end":this._icon.move({x:o.width/2-s.width/3,y:-(o.height/2)-s.height/3})}var u=this,a=i.selectAll(".annotation").data(this.annotationIcons());a.enter().append("g").attr("class","annotation").each(function(e,t){u._annotationWidgets[t]=(new n).target(this).shape("square")});var f=o.width/2,l=o.height/2;a.each(function(e,t){var n=u._annotationWidgets[t];n.diameter(u.annotationDiameter()).shape_colorFill(u.textbox_shape_colorFill()).shape_colorStroke(u.textbox_shape_colorStroke());for(var r in e)n[r]&&n[r](e[r]);n.render();var i=n.getBBox(!0);n.move({x:f-i.width/4,y:l+i.height/4}),f-=i.width+u.annotationSpacing()}),a.exit().each(function(t,n){var r=e.select(this);delete u._annotationWidgets[n],r.remove()})},i.prototype.intersection=function(e,t){var n=this._icon.intersection(e,t,this._pos);if(n)return n;var r=this._textBox.intersection(e,t,this._pos);return r?r:null},i});