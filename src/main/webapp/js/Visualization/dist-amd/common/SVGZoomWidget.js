(function(e,t){typeof define=="function"&&define.amd?define(["d3","../common/SVGWidget","../common/Icon","css!./SVGZoomWidget"],t):e.common_SVGZoomWidget=t(e.d3,e.common_SVGWidget,e.common_Icon)})(this,function(e,t,n){function r(e){t.call(this)}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" common_SVGZoomWidget",r.prototype.publish("zoomToolbar",!0,"boolean","Show Zoom Toolbar"),r.prototype.publish("zoomDuration",250,"number","Transition Duration"),r.prototype.zoomTo=function(e,t,n){e=e||this._zoom.translate(),t=t||this._zoom.scale(),n=n===undefined?this.zoomDuration():0,this._zoomElement.transition().duration(n).call(this._zoom.translate(e).scale(t).event)},r.prototype.zoomToFit=function(e){var t=this._renderElement.node().getBBox();if(t.width&&t.height){var n=t.x+t.width/2,r=t.y+t.height/2,i=t.width,s=t.height,o=this.width(),u=this.height(),a=1/Math.max(i/o,s/u),f=[o/2-a*n,u/2-a*r];this.zoomTo(f,a,e)}},r.prototype.enter=function(n,r){t.prototype.enter.apply(this,arguments),this._zoomElement=r.append("g"),this._zoomGrab=this._zoomElement.append("rect").attr("class","background"),this._zoomG=this._zoomElement.append("g"),this._renderElement=this._zoomG.append("g");var i=this;this._zoom=e.behavior.zoom().scaleExtent([.05,20]).on("zoom",function(){i._zoomG.attr("transform","translate("+e.event.translate+")scale("+e.event.scale+")")}),this._zoomElement.call(this._zoom)},r.prototype.update=function(e,r){t.prototype.update.apply(this,arguments),this._zoomGrab.attr("width",this.width()).attr("height",this.height());var i=this,s=r.selectAll(".toolbar").data(this.zoomToolbar()?["dummy"]:[]),o=24,u=14;s.enter().append("g").attr("class","toolbar").each(function(e){i._buttonToFit=(new n).target(this).faChar("").shape("square").diameter(o).paddingPercent((1-u/o)*100).on("click",function(){i.zoomToFit()}),i._buttonPlus=(new n).target(this).faChar("").shape("square").diameter(o).paddingPercent((1-u/o)*100).on("click",function(){i.zoomTo(null,i._zoom.scale()*1.2)}),i._buttonMinus=(new n).target(this).faChar("").shape("square").diameter(o).paddingPercent((1-u/o)*100).on("click",function(){i.zoomTo(null,i._zoom.scale()/1.2)}),i._buttonLast=i._buttonMinus}),this.zoomToolbar()&&(this._buttonToFit.x(this.width()-o/2-4).y(o/2+4).render(),this._buttonPlus.x(this.width()-o/2-4).y(this._buttonToFit.y()+4+o).render(),this._buttonMinus.x(this.width()-o/2-4).y(this._buttonPlus.y()+o).render()),s.exit().each(function(){i._buttonToFit.target(null).render(),delete i._buttonToFit}).remove()},r.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},r});