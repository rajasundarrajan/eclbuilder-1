(function(e,t){typeof define=="function"&&define.amd?define(["../common/HTMLWidget","css!./Select"],t):e.other_Select=t(e.common_HTMLWidget)})(this,function(e){function t(t){e.call(this)}return t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.prototype._class+=" other_Select",t.prototype.publish("label",null,"string","Label for select"),t.prototype.publish("valueColumn",null,"set","Select display value",function(){return this.columns()},{optional:!0}),t.prototype.publish("textColumn",null,"set","Select value(s)",function(){return this.columns()},{optional:!0}),t.prototype.publish("multiple",!1,"boolean","Multiple selection"),t.prototype.publish("optional",!0,"boolean","Optional Select"),t.prototype.publish("selectSize",5,"number","Size of multiselect box",null,{disable:function(e){return!e.multiple()}}),t.prototype.selectData=function(){var e=this._db.rollupView([this.valueColumn(),this.textColumn()]);this._valueRowMap={};var t=[];return this.optional()&&t.push({value:"",text:""}),t.concat(e.entries().map(function(e){return this._valueRowMap[e.key]=e.values.length&&e.values[0].values.length?e.values[0].values[0]:[],{value:e.key,text:e.values.length?e.values[0].key:""}},this).sort(function(e,t){return e.text<t.text?-1:e.text>t.text?1:0}))},t.prototype.enter=function(t,n){e.prototype.enter.apply(this,arguments),this._span=n.append("span"),this._label=this._span.append("label").attr("for",this.id()+"_select");var r=this;this._select=this._span.append("select").attr("id",this.id()+"_select").on("change",function(e){var t=[],n=r._select.node().options;for(var i=0;i<n.length;++i){var s=n[i];s.selected&&t.push(s.value)}t.length&&r._valueRowMap[t[0]]?r.click(r._valueRowMap[t[0]],"value",!0):r.click([],"value",!1)})},t.prototype.update=function(t,n){e.prototype.update.apply(this,arguments),this._label.text(this.label()),this._select.attr("multiple",this.multiple()?this.multiple():null).attr("size",this.multiple()&&this.selectSize()?this.selectSize():null);var r=this._select.selectAll(".dataRow").data(this.selectData());r.enter().append("option").attr("class","dataRow"),r.attr("value",function(e){return e.value}).text(function(e){return e.text}),r.exit().remove()},t.prototype.exit=function(t,n){this._span.remove(),e.prototype.exit.apply(this,arguments)},t.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+", "+n)},t});