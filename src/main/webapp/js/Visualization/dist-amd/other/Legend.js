(function(e,t){typeof define=="function"&&define.amd?define(["d3","./Table","../common/Palette","css!./Legend"],t):e.other_Legend=t(e.d3,e.other_Table,e.common_Palette)})(this,function(e,t,n){function r(){t.call(this),this._tag="div",this.showHeader(!1)}function i(e){return'<div class="colorBlock" style="background-color:'+e+';"></div>'}function s(e){var t=e.toString().split(".")[0],n=e.toString().split(".")[1];while(/(\d+)(\d{3})/.test(t.toString()))t=t.toString().replace(/(\d+)(\d{3})/,"$1,$2");return typeof n!="undefined"?t+"."+n:t}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" other_Legend",r.prototype.publish("dataFamily","ND","set","Type of data",["1D","2D","ND","any"],{tags:["Private"]}),r.prototype.publish("orientation","vertical","set","Orientation of Legend rows",["vertical","horizontal"],{tags:["Private"]}),r.prototype.targetWidget=function(e){if(!arguments.length)return this._targetWidget;this._targetWidget=e,this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor);var t=this;return this._targetWidgetMonitor=this._targetWidget.monitor(function(e,n,r,i){switch(e){case"chart":case"columns":case"data":case"paletteID":t.lazyRender()}}),this},r.prototype.getWidget=function(){if(this._targetWidget)switch(this._targetWidget.classID()){case"chart_MultiChart":return this._targetWidget.chart()}return this._targetWidget},r.prototype.getPalette=function(){var e=this.getWidget();if(e&&e._palette)switch(e._palette.type()){case"ordinal":return n.ordinal(e._palette.id());case"rainbow":return n.rainbow(e._palette.id())}return n.ordinal("default")},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this.renderHtmlDataCells(!0),this.fixedHeader(!1),this.fixedSize(!0),n.classed("other_Legend",!0)},r.prototype.update=function(e,n){var r=["Key","Label"],o=[];if(this._targetWidget){var u=this.getPalette();switch(u.type()){case"ordinal":switch(this.dataFamily()){case"2D":o=this._targetWidget.data().map(function(e){return[i(u(e[0])),e[0]]},this);break;case"ND":var a=this._targetWidget.columns();o=a.filter(function(e,t){return t>0}).map(function(e){return[i(u(e)),e]},this)}break;case"rainbow":var f=u.colors().reverse(),l=f.length,c=this._targetWidget._dataMinWeight,h=this._targetWidget._dataMaxWeight;for(var p=0;p<l;p++){var d=parseInt((h-c)/l),v,m;p===0?(m=s(c+d*(p+1)),o.push([i(f[p]),"0 - "+m])):p+1===l?(v=s(c+d*p+1),o.push([i(f[p]),v+"+"])):(v=s(c+d*p+1),m=s(c+d*(p+1)),o.push([i(f[p]),v+" - "+m]))}}}this.columns(r),this.data(o),t.prototype.update.apply(this,arguments),n.classed("horiz-legend",this.orientation()==="horizontal");var g=n.select(".tableDiv > table"),y=g.node().getBoundingClientRect(),b=this._parentElement.node().getBoundingClientRect();n.select(".tableDiv").style({overflow:"visible"});var w=b.height/2-y.height/2,E=b.width/2-y.width/2;g.style({position:"absolute",top:w+"px",left:E+"px"});var S=this.pageNumber()-1,x=this.itemsPerPage(),T=S*x,N=parseInt(S*x)+parseInt(x),C=null;this.pagination()?C=this.data().slice(T,N):C=this.data();var k=this.tbody.selectAll("tr").data(C),L=this;k.on("click",function(e,t){L.onClick(e,t)}).on("mouseover",function(e,t){L.onMouseOver(e,t)})},r.prototype.exit=function(e,n){this._targetWidgetMonitor&&(this._targetWidgetMonitor.remove(),delete this._targetWidgetMonitor),t.prototype.exit.apply(this,arguments)},r.prototype.onClick=function(e,t){console.log("Legend onClick method"),console.log("rowData: "+e),console.log("rowIdx: "+t)},r.prototype.onMouseOver=function(e,t){console.log("Legend onMouseOver method"),console.log("rowData: "+e),console.log("rowIdx: "+t)},r});