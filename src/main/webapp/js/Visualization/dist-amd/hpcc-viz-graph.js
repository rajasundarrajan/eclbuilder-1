/*
Copyright (c) 2012-2014 Chris Pettitt

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/

/**
 * Copyright (c) 2014, Chris Pettitt
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. Neither the name of the copyright holder nor the names of its contributors
 * may be used to endorse or promote products derived from this software without
 * specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * @license
 * lodash 3.10.0 (Custom Build) <https://lodash.com/>
 * Build: `lodash modern -d -o ./index.js`
 * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <https://lodash.com/license>
 */

define("css!src/graph/Edge",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/Edge",["d3","../common/SVGWidget","../common/TextBox","css!./Edge"],t):e.graph_Edge=t(e.d3,e.common_SVGWidget,e.common_TextBox)}(this,function(e,t,n){function r(){t.call(this),this._points=[],this._weight=100,this._strokeDasharray=null,this._hidden=!1,this._textBox=(new n).padding(0)}return r.prototype=Object.create(t.prototype),r.prototype.constructor=r,r.prototype._class+=" graph_Edge",r.prototype.publish("arcDepth",16,"number","Arc Depth",null,{tags:["Basic"]}),r.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),r.prototype.sourceVertex=function(e){return arguments.length?(this._sourceVertex=e,this):this._sourceVertex},r.prototype.targetVertex=function(e){return arguments.length?(this._targetVertex=e,this):this._targetVertex},r.prototype.sourceMarker=function(e){return arguments.length?(this._sourceMarker=e,this):this._sourceMarker},r.prototype.targetMarker=function(e){return arguments.length?(this._targetMarker=e,this):this._targetMarker},r.prototype.weight=function(e){return arguments.length?(this._weight=e,this):this._weight},r.prototype.strokeDasharray=function(e){return arguments.length?(this._strokeDasharray=e,this):this._strokeDasharray},r.prototype.points=function(e,t,n){return arguments.length?(this._points=e,this._elementPath&&this.update(null,this._element,t,n),this):this._points},r.prototype.hidden=function(e){return arguments.length?(this._hidden=e,this):this._hidden},r.prototype.text=function(e){return arguments.length?(this._textBox.text(e),this):this._textBox.text()},r.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._elementPath=n.append("path"),this._tooltipElement=this._elementPath.append("title"),this._sourceMarker&&this._elementPath.attr("marker-start","url(#"+this._sourceMarker+")"),this._targetMarker&&this._elementPath.attr("marker-end","url(#"+this._targetMarker+")"),this._textBox.text()&&this._textBox.target(e).tooltip(this.tooltip()).render()},r.prototype.update=function(n,r,i,s){t.prototype.update.apply(this,arguments);var o=this;this.svgMarkerGlitch&&!s&&r.transition().duration((i?i:0)+100).each("start",function(e){o._pushMarkers(r,e)}).each("end",function(e){o._popMarkers(r,e)});var u=o._calculateEdgePoints(this._sourceVertex,this._targetVertex,this._points),a="";if(this._points.length||i||!0)a=e.svg.line().x(function(e){return e.x}).y(function(e){return e.y}).interpolate("bundle").tension(.75)(u);else{var f=u[2].x-u[0].x,l=u[2].y-u[0].y,c=Math.sqrt(f*f+l*l)*2;a="M"+u[0].x+","+u[0].y+"A"+c+","+c+" 0 0,1 "+u[2].x+","+u[2].y}var h=this._elementPath;i&&(h=h.transition().duration(i)),h.attr("opacity",this._hidden?0:1).attr("stroke-dasharray",this._strokeDasharray).attr("d",a),this._tooltipElement.text(this.tooltip()),this._textBox.text()&&this._textBox.tooltip(this.tooltip()).move(this._findMidPoint(u),i)},r.prototype._findMidPoint=function(e){var t=e.length/2;if(e.length%2)return e[Math.floor(t)];if(e.length){var n=e[t-1],r=e[t];return{x:(n.x+r.x)/2,y:(n.y+r.y)/2}}return{x:0,y:0}},r.prototype._calculateEdgePoints=function(e,t,n){if(!e||!t)return[{x:0,y:0},{x:0,y:0}];var r=n?n.slice():[],i=r.length===0?t.pos():r[0],s=r.length===0?e.pos():r[r.length-1];r.unshift(e.intersection(e._pos,i)),r.push(t.intersection(t._pos,s)),r[0]||(r[0]=e._pos),r[r.length-1]||(r[r.length-1]=t._pos);if(r.length===2&&r[0]&&r[1]){var o=r[0].x-r[1].x,u=r[0].y-r[1].y,a=Math.sqrt(o*o+u*u);if(a){var f=(r[0].x+r[1].x)/2-u*this.arcDepth()/100,l=(r[0].y+r[1].y)/2+o*this.arcDepth()/100;r=[{x:r[0].x,y:r[0].y},{x:f,y:l},{x:r[1].x,y:r[1].y}]}}return r},r}),define("css!src/graph/Vertex",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/Vertex",["d3","../common/SVGWidget","../common/Icon","../common/TextBox","css!./Vertex"],t):e.graph_Vertex=t(e.d3,e.common_SVGWidget,e.common_Icon,e.common_TextBox)}(this,function(e,t,n,r){function i(){t.call(this),this._icon=new n,this._textBox=new r,this._annotationWidgets={}}return i.prototype=Object.create(t.prototype),i.prototype.constructor=i,i.prototype._class+=" graph_Vertex",i.prototype.publishProxy("faChar","_icon"),i.prototype.publishProxy("icon_shape_diameter","_icon","diameter"),i.prototype.publishProxy("icon_shape_colorFill","_icon","shape_colorFill"),i.prototype.publishProxy("icon_shape_colorStroke","_icon","shape_colorStroke"),i.prototype.publishProxy("icon_image_colorFill","_icon","image_colorFill"),i.prototype.publishProxy("text","_textBox"),i.prototype.publishProxy("anchor","_textBox"),i.prototype.publishProxy("textbox_shape_colorStroke","_textBox","shape_colorStroke"),i.prototype.publishProxy("textbox_shape_colorFill","_textBox","shape_colorFill"),i.prototype.publishProxy("textbox_text_colorFill","_textBox","text_colorFill"),i.prototype.publish("iconAnchor","start","set","Icon Anchor Position",["","start","middle","end"],{tags:["Basic"]}),i.prototype.publish("tooltip","","string","Tooltip",null,{tags:["Private"]}),i.prototype.publish("annotationDiameter",14,"number","Annotation Diameter",null,{tags:["Private"]}),i.prototype.publish("annotationSpacing",3,"number","Annotation Spacing",null,{tags:["Private"]}),i.prototype.publish("annotationIcons",[],"array","Annotations",null,{tags:["Private"]}),i.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._icon.target(e).render(),this._textBox.target(e).render()},i.prototype.update=function(r,i){t.prototype.update.apply(this,arguments),this._icon.tooltip(this.tooltip()).render();var s=this._icon.getBBox(!0);this._textBox.tooltip(this.tooltip()).render();var o=this._textBox.getBBox(!0);switch(this.iconAnchor()){case"start":this._icon.move({x:-(o.width/2)+s.width/3,y:-(o.height/2)-s.height/3});break;case"middle":this._icon.move({x:0,y:-(o.height/2)-s.height/3});break;case"end":this._icon.move({x:o.width/2-s.width/3,y:-(o.height/2)-s.height/3})}var u=this,a=i.selectAll(".annotation").data(this.annotationIcons());a.enter().append("g").attr("class","annotation").each(function(e,t){u._annotationWidgets[t]=(new n).target(this).shape("square")});var f=o.width/2,l=o.height/2;a.each(function(e,t){var n=u._annotationWidgets[t];n.diameter(u.annotationDiameter()).shape_colorFill(u.textbox_shape_colorFill()).shape_colorStroke(u.textbox_shape_colorStroke());for(var r in e)n[r]&&n[r](e[r]);n.render();var i=n.getBBox(!0);n.move({x:f-i.width/4,y:l+i.height/4}),f-=i.width+u.annotationSpacing()}),a.exit().each(function(t,n){var r=e.select(this);delete u._annotationWidgets[n],r.remove()})},i.prototype.intersection=function(e,t){var n=this._icon.intersection(e,t,this._pos);if(n)return n;var r=this._textBox.intersection(e,t,this._pos);return r?r:null},i}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("dagre",[],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.dagre=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=t[o]={exports:{}};e[o][0].call(l.exports,function(t){var n=e[o][1][t];return i(n?n:t)},l,l.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){t.exports={graphlib:e("./lib/graphlib"),layout:e("./lib/layout"),debug:e("./lib/debug"),util:{time:e("./lib/util").time,notime:e("./lib/util").notime},version:e("./lib/version")}},{"./lib/debug":6,"./lib/graphlib":7,"./lib/layout":9,"./lib/util":29,"./lib/version":30}],2:[function(e,t,n){"use strict";function s(e){function n(e){return function(t){return e.edge(t).weight}}var t=e.graph().acyclicer==="greedy"?i(e,n(e)):o(e);r.each(t,function(t){var n=e.edge(t);e.removeEdge(t),n.forwardName=t.name,n.reversed=!0,e.setEdge(t.w,t.v,n,r.uniqueId("rev"))})}function o(e){function s(o){if(r.has(i,o))return;i[o]=!0,n[o]=!0,r.each(e.outEdges(o),function(e){r.has(n,e.w)?t.push(e):s(e.w)}),delete n[o]}var t=[],n={},i={};return r.each(e.nodes(),s),t}function u(e){r.each(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var r=e("./lodash"),i=e("./greedy-fas");t.exports={run:s,undo:u}},{"./greedy-fas":8,"./lodash":10}],3:[function(e,t,n){function s(e){function t(n){var i=e.children(n),s=e.node(n);i.length&&r.each(i,t);if(r.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var u=s.minRank,a=s.maxRank+1;u<a;++u)o(e,"borderLeft","_bl",n,s,u),o(e,"borderRight","_br",n,s,u)}}r.each(e.children(),t)}function o(e,t,n,r,s,o){var u={width:0,height:0,rank:o,borderType:t},a=s[t][o-1],f=i.addDummyNode(e,"border",u,n);s[t][o]=f,e.setParent(f,r),a&&e.setEdge(a,f,{weight:1})}var r=e("./lodash"),i=e("./util");t.exports=s},{"./lodash":10,"./util":29}],4:[function(e,t,n){"use strict";function i(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&o(e)}function s(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&a(e);if(t==="lr"||t==="rl")l(e),o(e)}function o(e){r.each(e.nodes(),function(t){u(e.node(t))}),r.each(e.edges(),function(t){u(e.edge(t))})}function u(e){var t=e.width;e.width=e.height,e.height=t}function a(e){r.each(e.nodes(),function(t){f(e.node(t))}),r.each(e.edges(),function(t){var n=e.edge(t);r.each(n.points,f),r.has(n,"y")&&f(n)})}function f(e){e.y=-e.y}function l(e){r.each(e.nodes(),function(t){c(e.node(t))}),r.each(e.edges(),function(t){var n=e.edge(t);r.each(n.points,c),r.has(n,"x")&&c(n)})}function c(e){var t=e.x;e.x=e.y,e.y=t}var r=e("./lodash");t.exports={adjust:i,undo:s}},{"./lodash":10}],5:[function(e,t,n){function r(){var e={};e._next=e._prev=e,this._sentinel=e}function i(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function s(e,t){if(e!=="_next"&&e!=="_prev")return t}t.exports=r,r.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return i(t),t},r.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&i(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},r.prototype.toString=function(){var e=[],t=this._sentinel,n=t._prev;while(n!==t)e.push(JSON.stringify(n,s)),n=n._prev;return"["+e.join(", ")+"]"}},{}],6:[function(e,t,n){function o(e){var t=i.buildLayerMatrix(e),n=(new s({compound:!0,multigraph:!0})).setGraph({});return r.each(e.nodes(),function(t){n.setNode(t,{label:t}),n.setParent(t,"layer"+e.node(t).rank)}),r.each(e.edges(),function(e){n.setEdge(e.v,e.w,{},e.name)}),r.each(t,function(e,t){var i="layer"+t;n.setNode(i,{rank:"same"}),r.reduce(e,function(e,t){return n.setEdge(e,t,{style:"invis"}),t})}),n}var r=e("./lodash"),i=e("./util"),s=e("./graphlib").Graph;t.exports={debugOrdering:o}},{"./graphlib":7,"./lodash":10,"./util":29}],7:[function(e,t,n){var r;if(e)try{r=e("graphlib")}catch(i){}r||(r=window.graphlib),t.exports=r},{graphlib:31}],8:[function(e,t,n){function u(e,t){if(e.nodeCount()<=1)return[];var n=l(e,t||o),i=a(n.graph,n.buckets,n.zeroIdx);return r.flatten(r.map(i,function(t){return e.outEdges(t.v,t.w)}),!0)}function a(e,t,n){var r=[],i=t[t.length-1],s=t[0],o;while(e.nodeCount()){while(o=s.dequeue())f(e,t,n,o);while(o=i.dequeue())f(e,t,n,o);if(e.nodeCount())for(var u=t.length-2;u>0;--u){o=t[u].dequeue();if(o){r=r.concat(f(e,t,n,o,!0));break}}}return r}function f(e,t,n,i,s){var o=s?[]:undefined;return r.each(e.inEdges(i.v),function(r){var i=e.edge(r),u=e.node(r.v);s&&o.push({v:r.v,w:r.w}),u.out-=i,c(t,n,u)}),r.each(e.outEdges(i.v),function(r){var i=e.edge(r),s=r.w,o=e.node(s);o["in"]-=i,c(t,n,o)}),e.removeNode(i.v),o}function l(e,t){var n=new i,o=0,u=0;r.each(e.nodes(),function(e){n.setNode(e,{v:e,"in":0,out:0})}),r.each(e.edges(),function(e){var r=n.edge(e.v,e.w)||0,i=t(e),s=r+i;n.setEdge(e.v,e.w,s),u=Math.max(u,n.node(e.v).out+=i),o=Math.max(o,n.node(e.w)["in"]+=i)});var a=r.range(u+o+3).map(function(){return new s}),f=o+1;return r.each(n.nodes(),function(e){c(a,f,n.node(e))}),{graph:n,buckets:a,zeroIdx:f}}function c(e,t,n){n.out?n["in"]?e[n.out-n["in"]+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var r=e("./lodash"),i=e("./graphlib").Graph,s=e("./data/list");t.exports=u;var o=r.constant(1)},{"./data/list":5,"./graphlib":7,"./lodash":10}],9:[function(e,t,n){"use strict";function g(e,t){var n=t&&t.debugTiming?v.time:v.notime;n("layout",function(){var t=n("  buildLayoutGraph",function(){return L(e)});n("  runLayout",function(){y(t,n)}),n("  updateInputGraph",function(){b(e,t)})})}function y(e,t){t("    makeSpaceForEdgeLabels",function(){A(e)}),t("    removeSelfEdges",function(){F(e)}),t("    acyclic",function(){i.run(e)}),t("    nestingGraph.run",function(){l.run(e)}),t("    rank",function(){o(v.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){O(e)}),t("    removeEmptyRanks",function(){f(e)}),t("    nestingGraph.cleanup",function(){l.cleanup(e)}),t("    normalizeRanks",function(){u(e)}),t("    assignRankMinMax",function(){M(e)}),t("    removeEdgeLabelProxies",function(){_(e)}),t("    normalize.run",function(){s.run(e)}),t("    parentDummyChains",function(){a(e)}),t("    addBorderSegments",function(){c(e)}),t("    order",function(){p(e)}),t("    insertSelfEdges",function(){I(e)}),t("    adjustCoordinateSystem",function(){h.adjust(e)}),t("    position",function(){d(e)}),t("    positionSelfEdges",function(){q(e)}),t("    removeBorderNodes",function(){j(e)}),t("    normalize.undo",function(){s.undo(e)}),t("    fixupEdgeLabelCoords",function(){H(e)}),t("    undoCoordinateSystem",function(){h.undo(e)}),t("    translateGraph",function(){D(e)}),t("    assignNodeIntersects",function(){P(e)}),t("    reversePoints",function(){B(e)}),t("    acyclic.undo",function(){i.undo(e)})}function b(e,t){r.each(e.nodes(),function(n){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}),r.each(e.edges(),function(n){var i=e.edge(n),s=t.edge(n);i.points=s.points,r.has(s,"x")&&(i.x=s.x,i.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}function L(e){var t=new m({multigraph:!0,compound:!0}),n=U(e.graph());return t.setGraph(r.merge({},E,R(n,w),r.pick(n,S))),r.each(e.nodes(),function(n){var i=U(e.node(n));t.setNode(n,r.defaults(R(i,x),T)),t.setParent(n,e.parent(n))}),r.each(e.edges(),function(n){var i=U(e.edge(n));t.setEdge(n,r.merge({},C,R(i,N),r.pick(i,k)))}),t}function A(e){var t=e.graph();t.ranksep/=2,r.each(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function O(e){r.each(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w),s={rank:(i.rank-r.rank)/2+r.rank,e:t};v.addDummyNode(e,"edge-proxy",s,"_ep")}})}function M(e){var t=0;r.each(e.nodes(),function(n){var i=e.node(n);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,t=r.max(t,i.maxRank))}),e.graph().maxRank=t}function _(e){r.each(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function D(e){function f(e){var r=e.x,o=e.y,u=e.width,a=e.height;t=Math.min(t,r-u/2),n=Math.max(n,r+u/2),i=Math.min(i,o-a/2),s=Math.max(s,o+a/2)}var t=Number.POSITIVE_INFINITY,n=0,i=Number.POSITIVE_INFINITY,s=0,o=e.graph(),u=o.marginx||0,a=o.marginy||0;r.each(e.nodes(),function(t){f(e.node(t))}),r.each(e.edges(),function(t){var n=e.edge(t);r.has(n,"x")&&f(n)}),t-=u,i-=a,r.each(e.nodes(),function(n){var r=e.node(n);r.x-=t,r.y-=i}),r.each(e.edges(),function(n){var s=e.edge(n);r.each(s.points,function(e){e.x-=t,e.y-=i}),r.has(s,"x")&&(s.x-=t),r.has(s,"y")&&(s.y-=i)}),o.width=n-t+u,o.height=s-i+a}function P(e){r.each(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),i=e.node(t.w),s,o;n.points?(s=n.points[0],o=n.points[n.points.length-1]):(n.points=[],s=i,o=r),n.points.unshift(v.intersectRect(r,s)),n.points.push(v.intersectRect(i,o))})}function H(e){r.each(e.edges(),function(t){var n=e.edge(t);if(r.has(n,"x")){if(n.labelpos==="l"||n.labelpos==="r")n.width-=n.labeloffset;switch(n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}})}function B(e){r.each(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function j(e){r.each(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),i=e.node(n.borderTop),s=e.node(n.borderBottom),o=e.node(r.last(n.borderLeft)),u=e.node(r.last(n.borderRight));n.width=Math.abs(u.x-o.x),n.height=Math.abs(s.y-i.y),n.x=o.x+n.width/2,n.y=i.y+n.height/2}}),r.each(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function F(e){r.each(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function I(e){var t=v.buildLayerMatrix(e);r.each(t,function(t){var n=0;r.each(t,function(t,i){var s=e.node(t);s.order=i+n,r.each(s.selfEdges,function(t){v.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:s.rank,order:i+ ++n,e:t.e,label:t.label},"_se")}),delete s.selfEdges})})}function q(e){r.each(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),i=r.x+r.width/2,s=r.y,o=n.x-i,u=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*o/3,y:s-u},{x:i+5*o/6,y:s-u},{x:i+o,y:s},{x:i+5*o/6,y:s+u},{x:i+2*o/3,y:s+u}],n.label.x=n.x,n.label.y=n.y}})}function R(e,t){return r.mapValues(r.pick(e,t),Number)}function U(e){var t={};return r.each(e,function(e,n){t[n.toLowerCase()]=e}),t}var r=e("./lodash"),i=e("./acyclic"),s=e("./normalize"),o=e("./rank"),u=e("./util").normalizeRanks,a=e("./parent-dummy-chains"),f=e("./util").removeEmptyRanks,l=e("./nesting-graph"),c=e("./add-border-segments"),h=e("./coordinate-system"),p=e("./order"),d=e("./position"),v=e("./util"),m=e("./graphlib").Graph;t.exports=g;var w=["nodesep","edgesep","ranksep","marginx","marginy"],E={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},S=["acyclicer","ranker","rankdir","align"],x=["width","height"],T={width:0,height:0},N=["minlen","weight","width","height","labeloffset"],C={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},k=["labelpos"]},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./graphlib":7,"./lodash":10,"./nesting-graph":11,"./normalize":12,"./order":17,"./parent-dummy-chains":22,"./position":24,"./rank":26,"./util":29}],10:[function(e,t,n){var r;if(e)try{r=e("lodash")}catch(i){}r||(r=window._),t.exports=r},{lodash:51}],11:[function(e,t,n){function s(e){var t=i.addDummyNode(e,"root",{},"_root"),n=u(e),s=r.max(n)-1,f=2*s+1;e.graph().nestingRoot=t,r.each(e.edges(),function(t){e.edge(t).minlen*=f});var l=a(e)+1;r.each(e.children(),function(r){o(e,t,f,l,s,n,r)}),e.graph().nodeRankFactor=f}function o(e,t,n,s,u,a,f){var l=e.children(f);if(!l.length){f!==t&&e.setEdge(t,f,{weight:0,minlen:n});return}var c=i.addBorderNode(e,"_bt"),h=i.addBorderNode(e,"_bb"),p=e.node(f);e.setParent(c,f),p.borderTop=c,e.setParent(h,f),p.borderBottom=h,r.each(l,function(r){o(e,t,n,s,u,a,r);var i=e.node(r),l=i.borderTop?i.borderTop:r,p=i.borderBottom?i.borderBottom:r,d=i.borderTop?s:2*s,m=l!==p?1:u-a[f]+1;e.setEdge(c,l,{weight:d,minlen:m,nestingEdge:!0}),e.setEdge(p,h,{weight:d,minlen:m,nestingEdge:!0})}),e.parent(f)||e.setEdge(t,c,{weight:0,minlen:u+a[f]})}function u(e){function n(i,s){var o=e.children(i);o&&o.length&&r.each(o,function(e){n(e,s+1)}),t[i]=s}var t={};return r.each(e.children(),function(e){n(e,1)}),t}function a(e){return r.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function f(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,r.each(e.edges(),function(t){var n=e.edge(t);n.nestingEdge&&e.removeEdge(t)})}var r=e("./lodash"),i=e("./util");t.exports={run:s,cleanup:f}},{"./lodash":10,"./util":29}],12:[function(e,t,n){"use strict";function s(e){e.graph().dummyChains=[],r.each(e.edges(),function(t){o(e,t)})}function o(e,t){var n=t.v,r=e.node(n).rank,s=t.w,o=e.node(s).rank,u=t.name,a=e.edge(t),f=a.labelRank;if(o===r+1)return;e.removeEdge(t);var l,c,h;for(h=0,++r;r<o;++h,++r)a.points=[],c={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},l=i.addDummyNode(e,"edge",c,"_d"),r===f&&(c.width=a.width,c.height=a.height,c.dummy="edge-label",c.labelpos=a.labelpos),e.setEdge(n,l,{weight:a.weight},u),h===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,s,{weight:a.weight},u)}function u(e){r.each(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,i;e.setEdge(n.edgeObj,r);while(n.dummy)i=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=i,n=e.node(t)})}var r=e("./lodash"),i=e("./util");t.exports={run:s,undo:u}},{"./lodash":10,"./util":29}],13:[function(e,t,n){function i(e,t,n){var i={},s;r.each(n,function(n){var r=e.parent(n),o,u;while(r){o=e.parent(r),o?(u=i[o],i[o]=r):(u=s,s=r);if(u&&u!==r){t.setEdge(u,r);return}r=o}})}var r=e("../lodash");t.exports=i},{"../lodash":10}],14:[function(e,t,n){function i(e,t){return r.map(t,function(t){var n=e.inEdges(t);if(!n.length)return{v:t};var i=r.reduce(n,function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}},{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}})}var r=e("../lodash");t.exports=i},{"../lodash":10}],15:[function(e,t,n){function s(e,t,n){var s=o(e),u=(new i({compound:!0})).setGraph({root:s}).setDefaultNodeLabel(function(t){return e.node(t)});return r.each(e.nodes(),function(i){var o=e.node(i),a=e.parent(i);if(o.rank===t||o.minRank<=t&&t<=o.maxRank)u.setNode(i),u.setParent(i,a||s),r.each(e[n](i),function(t){var n=t.v===i?t.w:t.v,s=u.edge(n,i),o=r.isUndefined(s)?0:s.weight;u.setEdge(n,i,{weight:e.edge(t).weight+o})}),r.has(o,"minRank")&&u.setNode(i,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]})}),u}function o(e){var t;while(e.hasNode(t=r.uniqueId("_root")));return t}var r=e("../lodash"),i=e("../graphlib").Graph;t.exports=s},{"../graphlib":7,"../lodash":10}],16:[function(e,t,n){"use strict";function i(e,t){var n=0;for(var r=1;r<t.length;++r)n+=s(e,t[r-1],t[r]);return n}function s(e,t,n){var i=r.zipObject(n,r.map(n,function(e,t){return t})),s=r.flatten(r.map(t,function(t){return r.chain(e.outEdges(t)).map(function(t){return{pos:i[t.w],weight:e.edge(t).weight}}).sortBy("pos").value()}),!0),o=1;while(o<n.length)o<<=1;var u=2*o-1;o-=1;var a=r.map(new Array(u),function(){return 0}),f=0;return r.each(s.forEach(function(e){var t=e.pos+o;a[t]+=e.weight;var n=0;while(t>0)t%2&&(n+=a[t+1]),t=t-1>>1,a[t]+=e.weight;f+=e.weight*n})),f}var r=e("../lodash");t.exports=i},{"../lodash":10}],17:[function(e,t,n){"use strict";function c(e){var t=l.maxRank(e),n=h(e,r.range(1,t+1),"inEdges"),o=h(e,r.range(t-1,-1,-1),"outEdges"),u=i(e);d(e,u);var a=Number.POSITIVE_INFINITY,f;for(var c=0,v=0;v<4;++c,++v){p(c%2?n:o,c%4>=2),u=l.buildLayerMatrix(e);var m=s(e,u);m<a&&(v=0,f=r.cloneDeep(u),a=m)}d(e,f)}function h(e,t,n){return r.map(t,function(t){return u(e,t,n)})}function p(e,t){var n=new f;r.each(e,function(e){var i=e.graph().root,s=o(e,i,n,t);r.each(s.vs,function(t,n){e.node(t).order=n}),a(e,n,s.vs)})}function d(e,t){r.each(t,function(t){r.each(t,function(t,n){e.node(t).order=n})})}var r=e("../lodash"),i=e("./init-order"),s=e("./cross-count"),o=e("./sort-subgraph"),u=e("./build-layer-graph"),a=e("./add-subgraph-constraints"),f=e("../graphlib").Graph,l=e("../util");t.exports=c},{"../graphlib":7,"../lodash":10,"../util":29,"./add-subgraph-constraints":13,"./build-layer-graph":15,"./cross-count":16,"./init-order":18,"./sort-subgraph":20}],18:[function(e,t,n){"use strict";function i(e){function o(n){if(r.has(t,n))return;t[n]=!0;var i=e.node(n);s[i.rank].push(n),r.each(e.successors(n),o)}var t={},n=r.filter(e.nodes(),function(t){return!e.children(t).length}),i=r.max(r.map(n,function(t){return e.node(t).rank})),s=r.map(r.range(i+1),function(){return[]}),u=r.sortBy(n,function(t){return e.node(t).rank});return r.each(u,o),s}var r=e("../lodash");t.exports=i},{"../lodash":10}],19:[function(e,t,n){"use strict";function i(e,t){var n={};r.each(e,function(e,t){var i=n[e.v]={indegree:0,"in":[],out:[],vs:[e.v],i:t};r.isUndefined(e.barycenter)||(i.barycenter=e.barycenter,i.weight=e.weight)}),r.each(t.edges(),function(e){var t=n[e.v],i=n[e.w];!r.isUndefined(t)&&!r.isUndefined(i)&&(i.indegree++,t.out.push(n[e.w]))});var i=r.filter(n,function(e){return!e.indegree});return s(i)}function s(e){function n(e){return function(t){if(t.merged)return;(r.isUndefined(t.barycenter)||r.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&o(e,t)}}function i(t){return function(n){n["in"].push(t),--n.indegree===0&&e.push(n)}}var t=[];while(e.length){var s=e.pop();t.push(s),r.each(s["in"].reverse(),n(s)),r.each(s.out,i(s))}return r.chain(t).filter(function(e){return!e.merged}).map(function(e){return r.pick(e,["vs","i","barycenter","weight"])}).value()}function o(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var r=e("../lodash");t.exports=i},{"../lodash":10}],20:[function(e,t,n){function u(e,t,n,l){var c=e.children(t),h=e.node(t),p=h?h.borderLeft:undefined,d=h?h.borderRight:undefined,v={};p&&(c=r.filter(c,function(e){return e!==p&&e!==d}));var m=i(e,c);r.each(m,function(t){if(e.children(t.v).length){var i=u(e,t.v,n,l);v[t.v]=i,r.has(i,"barycenter")&&f(t,i)}});var g=s(m,n);a(g,v);var y=o(g,l);if(p){y.vs=r.flatten([p,y.vs,d],!0);if(e.predecessors(p).length){var b=e.node(e.predecessors(p)[0]),w=e.node(e.predecessors(d)[0]);r.has(y,"barycenter")||(y.barycenter=0,y.weight=0),y.barycenter=(y.barycenter*y.weight+b.order+w.order)/(y.weight+2),y.weight+=2}}return y}function a(e,t){r.each(e,function(e){e.vs=r.flatten(e.vs.map(function(e){return t[e]?t[e].vs:e}),!0)})}function f(e,t){r.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var r=e("../lodash"),i=e("./barycenter"),s=e("./resolve-conflicts"),o=e("./sort");t.exports=u},{"../lodash":10,"./barycenter":14,"./resolve-conflicts":19,"./sort":21}],21:[function(e,t,n){function s(e,t){var n=i.partition(e,function(e){return r.has(e,"barycenter")}),s=n.lhs,a=r.sortBy(n.rhs,function(e){return-e.i}),f=[],l=0,c=0,h=0;s.sort(u(!!t)),h=o(f,a,h),r.each(s,function(e){h+=e.vs.length,f.push(e.vs),l+=e.barycenter*e.weight,c+=e.weight,h=o(f,a,h)});var p={vs:r.flatten(f,!0)};return c&&(p.barycenter=l/c,p.weight=c),p}function o(e,t,n){var i;while(t.length&&(i=r.last(t)).i<=n)t.pop(),e.push(i.vs),n++;return n}function u(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var r=e("../lodash"),i=e("../util");t.exports=s},{"../lodash":10,"../util":29}],22:[function(e,t,n){function i(e){var t=o(e);r.each(e.graph().dummyChains,function(n){var r=e.node(n),i=r.edgeObj,o=s(e,t,i.v,i.w),u=o.path,a=o.lca,f=0,l=u[f],c=!0;while(n!==i.w){r=e.node(n);if(c){while((l=u[f])!==a&&e.node(l).maxRank<r.rank)f++;l===a&&(c=!1)}if(!c){while(f<u.length-1&&e.node(l=u[f+1]).minRank<=r.rank)f++;l=u[f]}e.setParent(n,l),n=e.successors(n)[0]}})}function s(e,t,n,r){var i=[],s=[],o=Math.min(t[n].low,t[r].low),u=Math.max(t[n].lim,t[r].lim),a,f;a=n;do a=e.parent(a),i.push(a);while(a&&(t[a].low>o||u>t[a].lim));f=a,a=r;while((a=e.parent(a))!==f)s.push(a);return{path:i.concat(s.reverse()),lca:f}}function o(e){function i(s){var o=n;r.each(e.children(s),i),t[s]={low:o,lim:n++}}var t={},n=0;return r.each(e.children(),i),t}var r=e("./lodash");t.exports=i},{"./lodash":10}],23:[function(e,t,n){"use strict";function o(e,t){function i(t,i){var s=0,o=0,u=t.length,l=r.last(i);return r.each(i,function(t,c){var h=a(e,t),p=h?e.node(h).order:u;if(h||t===l)r.each(i.slice(o,c+1),function(t){r.each(e.predecessors(t),function(r){var i=e.node(r),o=i.order;(o<s||p<o)&&(!i.dummy||!e.node(t).dummy)&&f(n,r,t)})}),o=c+1,s=p}),i}var n={};return r.reduce(t,i),n}function u(e,t){function i(t,i,s,o,u){var a;r.each(r.range(i,s),function(i){a=t[i],e.node(a).dummy&&r.each(e.predecessors(a),function(t){var r=e.node(t);r.dummy&&(r.order<o||r.order>u)&&f(n,t,a)})})}function s(t,n){var s=-1,o,u=0;return r.each(n,function(r,a){if(e.node(r).dummy==="border"){var f=e.predecessors(r);f.length&&(o=e.node(f[0]).order,i(n,u,a,s,o),u=a,s=o)}i(n,u,n.length,o,t.length)}),n}var n={};return r.reduce(t,s),n}function a(e,t){if(e.node(t).dummy)return r.find(e.predecessors(t),function(t){return e.node(t).dummy})}function f(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function l(e,t,n){if(t>n){var i=t;t=n,n=i}return r.has(e[t],n)}function c(e,t,n,i){var s={},o={},u={};return r.each(t,function(e){r.each(e,function(e,t){s[e]=e,o[e]=e,u[e]=t})}),r.each(t,function(e){var t=-1;r.each(e,function(e){var a=i(e);if(a.length){a=r.sortBy(a,function(e){return u[e]});var f=(a.length-1)/2;for(var c=Math.floor(f),h=Math.ceil(f);c<=h;++c){var p=a[c];o[e]===e&&t<u[p]&&!l(n,e,p)&&(o[p]=e,o[e]=s[e]=s[p],t=u[p])}}})}),{root:s,align:o}}function h(e,t,n,i,s){function f(e){r.has(a,e)||(a[e]=!0,o[e]=r.reduce(u.inEdges(e),function(e,t){return f(t.v),Math.max(e,o[t.v]+u.edge(t))},0))}function c(t){if(a[t]!==2){a[t]++;var n=e.node(t),i=r.reduce(u.outEdges(t),function(e,t){return c(t.w),Math.min(e,o[t.w]-u.edge(t))},Number.POSITIVE_INFINITY);i!==Number.POSITIVE_INFINITY&&n.borderType!==l&&(o[t]=Math.max(o[t],i))}}var o={},u=p(e,t,n,s),a={};r.each(u.nodes(),f);var l=s?"borderLeft":"borderRight";return r.each(u.nodes(),c),r.each(i,function(e){o[e]=o[n[e]]}),o}function p(e,t,n,s){var o=new i,u=e.graph(),a=y(u.nodesep,u.edgesep,s);return r.each(t,function(t){var i;r.each(t,function(t){var r=n[t];o.setNode(r);if(i){var s=n[i],u=o.edge(s,r);o.setEdge(s,r,Math.max(a(e,t,i),u||0))}i=t})}),o}function d(e,t){return r.min(t,function(t){var n=r.min(t,function(t,n){return t-b(e,n)/2}),i=r.max(t,function(t,n){return t+b(e,n)/2});return i-n})}function v(e,t){var n=r.min(t),i=r.max(t);r.each(["u","d"],function(s){r.each(["l","r"],function(o){var u=s+o,a=e[u],f;if(a===t)return;f=o==="l"?n-r.min(a):i-r.max(a),f&&(e[u]=r.mapValues(a,function(e){return e+f}))})})}function m(e,t){return r.mapValues(e.ul,function(n,i){if(t)return e[t.toLowerCase()][i];var s=r.sortBy(r.pluck(e,i));return(s[1]+s[2])/2})}function g(e){var t=s.buildLayerMatrix(e),n=r.merge(o(e,t),u(e,t)),i={},a;r.each(["u","d"],function(s){a=s==="u"?t:r.values(t).reverse(),r.each(["l","r"],function(t){t==="r"&&(a=r.map(a,function(e){return r.values(e).reverse()}));var o=r.bind(s==="u"?e.predecessors:e.successors,e),u=c(e,a,n,o),f=h(e,a,u.root,u.align,t==="r");t==="r"&&(f=r.mapValues(f,function(e){return-e})),i[s+t]=f})});var f=d(e,i);return v(i,f),m(i,e.graph().align)}function y(e,t,n){return function(i,s,o){var u=i.node(s),a=i.node(o),f=0,l;f+=u.width/2;if(r.has(u,"labelpos"))switch(u.labelpos.toLowerCase()){case"l":l=-u.width/2;break;case"r":l=u.width/2}l&&(f+=n?l:-l),l=0,f+=(u.dummy?t:e)/2,f+=(a.dummy?t:e)/2,f+=a.width/2;if(r.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2}return l&&(f+=n?l:-l),l=0,f}}function b(e,t){return e.node(t).width}var r=e("../lodash"),i=e("../graphlib").Graph,s=e("../util");t.exports={positionX:g,findType1Conflicts:o,findType2Conflicts:u,addConflict:f,hasConflict:l,verticalAlignment:c,horizontalCompaction:h,alignCoordinates:v,findSmallestWidthAlignment:d,balance:m}},{"../graphlib":7,"../lodash":10,"../util":29}],24:[function(e,t,n){"use strict";function o(e){e=i.asNonCompoundGraph(e),u(e),r.each(s(e),function(t,n){e.node(n).x=t})}function u(e){var t=i.buildLayerMatrix(e),n=e.graph().ranksep,s=0;r.each(t,function(t){var i=r.max(r.map(t,function(t){return e.node(t).height}));r.each(t,function(t){e.node(t).y=s+i/2}),s+=i+n})}var r=e("../lodash"),i=e("../util"),s=e("./bk").positionX;t.exports=o},{"../lodash":10,"../util":29,"./bk":23}],25:[function(e,t,n){"use strict";function o(e){var t=new i({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});var o,l;while(u(t,e)<r)o=a(t,e),l=t.hasNode(o.v)?s(e,o):-s(e,o),f(t,e,l);return t}function u(e,t){function n(i){r.each(t.nodeEdges(i),function(r){var o=r.v,u=i===o?r.w:o;!e.hasNode(u)&&!s(t,r)&&(e.setNode(u,{}),e.setEdge(i,u,{}),n(u))})}return r.each(e.nodes(),n),e.nodeCount()}function a(e,t){return r.min(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return s(t,n)})}function f(e,t,n){r.each(e.nodes(),function(e){t.node(e).rank+=n})}var r=e("../lodash"),i=e("../graphlib").Graph,s=e("./util").slack;t.exports=o},{"../graphlib":7,"../lodash":10,"./util":28}],26:[function(e,t,n){"use strict";function u(e){switch(e.graph().ranker){case"network-simplex":l(e);break;case"tight-tree":f(e);break;case"longest-path":a(e);break;default:l(e)}}function f(e){i(e),s(e)}function l(e){o(e)}var r=e("./util"),i=r.longestPath,s=e("./feasible-tree"),o=e("./network-simplex");t.exports=u;var a=i},{"./feasible-tree":25,"./network-simplex":27,"./util":28}],27:[function(e,t,n){"use strict";function l(e){e=f(e),o(e);var t=i(e);d(t),c(t,e);var n,r;while(n=m(t))r=g(t,e,n),y(t,e,n,r)}function c(e,t){var n=a(e,e.nodes());n=n.slice(0,n.length-1),r.each(n,function(n){h(e,t,n)})}function h(e,t,n){var r=e.node(n),i=r.parent;e.edge(n,i).cutvalue=p(e,t,n)}function p(e,t,n){var i=e.node(n),s=i.parent,o=!0,u=t.edge(n,s),a=0;return u||(o=!1,u=t.edge(s,n)),a=u.weight,r.each(t.nodeEdges(n),function(r){var i=r.v===n,u=i?r.w:r.v;if(u!==s){var f=i===o,l=t.edge(r).weight;a+=f?l:-l;if(w(e,n,u)){var c=e.edge(n,u).cutvalue;a+=f?-c:c}}}),a}function d(e,t){arguments.length<2&&(t=e.nodes()[0]),v(e,{},1,t)}function v(e,t,n,i,s){var o=n,u=e.node(i);return t[i]=!0,r.each(e.neighbors(i),function(s){r.has(t,s)||(n=v(e,t,n,s,i))}),u.low=o,u.lim=n++,s?u.parent=s:delete u.parent,n}function m(e){return r.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function g(e,t,n){var i=n.v,o=n.w;t.hasEdge(i,o)||(i=n.w,o=n.v);var u=e.node(i),a=e.node(o),f=u,l=!1;u.lim>a.lim&&(f=a,l=!0);var c=r.filter(t.edges(),function(t){return l===E(e,e.node(t.v),f)&&l!==E(e,e.node(t.w),f)});return r.min(c,function(e){return s(t,e)})}function y(e,t,n,r){var i=n.v,s=n.w;e.removeEdge(i,s),e.setEdge(r.v,r.w,{}),d(e),c(e,t),b(e,t)}function b(e,t){var n=r.find(e.nodes(),function(e){return!t.node(e).parent}),i=u(e,n);i=i.slice(1),r.each(i,function(n){var r=e.node(n).parent,i=t.edge(n,r),s=!1;i||(i=t.edge(r,n),s=!0),t.node(n).rank=t.node(r).rank+(s?i.minlen:-i.minlen)})}function w(e,t,n){return e.hasEdge(t,n)}function E(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var r=e("../lodash"),i=e("./feasible-tree"),s=e("./util").slack,o=e("./util").longestPath,u=e("../graphlib").alg.preorder,a=e("../graphlib").alg.postorder,f=e("../util").simplify;t.exports=l,l.initLowLimValues=d,l.initCutValues=c,l.calcCutValue=p,l.leaveEdge=m,l.enterEdge=g,l.exchangeEdges=y},{"../graphlib":7,"../lodash":10,"../util":29,"./feasible-tree":25,"./util":28}],28:[function(e,t,n){"use strict";function i(e){function n(i){var s=e.node(i);if(r.has(t,i))return s.rank;t[i]=!0;var o=r.min(r.map(e.outEdges(i),function(t){return n(t.w)-e.edge(t).minlen}));return o===Number.POSITIVE_INFINITY&&(o=0),s.rank=o}var t={};r.each(e.sources(),n)}function s(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var r=e("../lodash");t.exports={longestPath:i,slack:s}},{"../lodash":10}],29:[function(e,t,n){"use strict";function s(e,t,n,i){var s;do s=r.uniqueId(i);while(e.hasNode(s));return n.dummy=t,e.setNode(s,n),s}function o(e){var t=(new i).setGraph(e.graph());return r.each(e.nodes(),function(n){t.setNode(n,e.node(n))}),r.each(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},i=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+i.weight,minlen:Math.max(r.minlen,i.minlen)})}),t}function u(e){var t=(new i({multigraph:e.isMultigraph()})).setGraph(e.graph());return r.each(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),r.each(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function a(e){var t=r.map(e.nodes(),function(t){var n={};return r.each(e.outEdges(t),function(t){n[t.w]=(n[t.w]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)}function f(e){var t=r.map(e.nodes(),function(t){var n={};return r.each(e.inEdges(t),function(t){n[t.v]=(n[t.v]||0)+e.edge(t).weight}),n});return r.zipObject(e.nodes(),t)}function l(e,t){var n=e.x,r=e.y,i=t.x-n,s=t.y-r,o=e.width/2,u=e.height/2;if(!i&&!s)throw new Error("Not possible to find intersection inside of the rectangle");var a,f;return Math.abs(s)*o>Math.abs(i)*u?(s<0&&(u=-u),a=u*i/s,f=u):(i<0&&(o=-o),a=o,f=o*s/i),{x:n+a,y:r+f}}function c(e){var t=r.map(r.range(v(e)+1),function(){return[]});return r.each(e.nodes(),function(n){var i=e.node(n),s=i.rank;r.isUndefined(s)||(t[s][i.order]=n)}),t}function h(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank}));r.each(e.nodes(),function(n){var i=e.node(n);r.has(i,"rank")&&(i.rank-=t)})}function p(e){var t=r.min(r.map(e.nodes(),function(t){return e.node(t).rank})),n=[];r.each(e.nodes(),function(r){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)});var i=0,s=e.graph().nodeRankFactor;r.each(n,function(t,n){r.isUndefined(t)&&n%s!==0?--i:i&&r.each(t,function(t){e.node(t).rank+=i})})}function d(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),s(e,"border",i,t)}function v(e){return r.max(r.map(e.nodes(),function(t){var n=e.node(t).rank;if(!r.isUndefined(n))return n}))}function m(e,t){var n={lhs:[],rhs:[]};return r.each(e,function(e){t(e)?n.lhs.push(e):n.rhs.push(e)}),n}function g(e,t){var n=r.now();try{return t()}finally{console.log(e+" time: "+(r.now()-n)+"ms")}}function y(e,t){return t()}var r=e("./lodash"),i=e("./graphlib").Graph;t.exports={addDummyNode:s,simplify:o,asNonCompoundGraph:u,successorWeights:a,predecessorWeights:f,intersectRect:l,buildLayerMatrix:c,normalizeRanks:h,removeEmptyRanks:p,addBorderNode:d,maxRank:v,partition:m,time:g,notime:y}},{"./graphlib":7,"./lodash":10}],30:[function(e,t,n){t.exports="0.7.3"},{}],31:[function(e,t,n){var r=e("./lib");t.exports={Graph:r.Graph,json:e("./lib/json"),alg:e("./lib/alg"),version:r.version}},{"./lib":47,"./lib/alg":38,"./lib/json":48}],32:[function(e,t,n){function i(e){function s(n){if(r.has(t,n))return;t[n]=!0,i.push(n),r.each(e.successors(n),s),r.each(e.predecessors(n),s)}var t={},n=[],i;return r.each(e.nodes(),function(e){i=[],s(e),i.length&&n.push(i)}),n}var r=e("../lodash");t.exports=i},{"../lodash":49}],33:[function(e,t,n){function i(e,t,n){r.isArray(t)||(t=[t]);var i=[],o={};return r.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);s(e,t,n==="post",o,i)}),i}function s(e,t,n,i,o){r.has(i,t)||(i[t]=!0,n||o.push(t),r.each(e.neighbors(t),function(t){s(e,t,n,i,o)}),n&&o.push(t))}var r=e("../lodash");t.exports=i},{"../lodash":49}],34:[function(e,t,n){function s(e,t,n){return i.transform(e.nodes(),function(i,s){i[s]=r(e,s,t,n)},{})}var r=e("./dijkstra"),i=e("../lodash");t.exports=s},{"../lodash":49,"./dijkstra":35}],35:[function(e,t,n){function o(e,t,n,r){return u(e,String(t),n||s,r||function(t){return e.outEdges(t)})}function u(e,t,n,r){var s={},o=new i,u,a,f=function(e){var t=e.v!==u?e.v:e.w,r=s[t],i=n(e),f=a.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+i);f<r.distance&&(r.distance=f,r.predecessor=u,o.decrease(t,f))};e.nodes().forEach(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;s[e]={distance:n},o.add(e,n)});while(o.size()>0){u=o.removeMin(),a=s[u];if(a.distance===Number.POSITIVE_INFINITY)break;r(u).forEach(f)}return s}var r=e("../lodash"),i=e("../data/priority-queue");t.exports=o;var s=r.constant(1)},{"../data/priority-queue":45,"../lodash":49}],36:[function(e,t,n){function s(e){return r.filter(i(e),function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}var r=e("../lodash"),i=e("./tarjan");t.exports=s},{"../lodash":49,"./tarjan":43}],37:[function(e,t,n){function s(e,t,n){return o(e,t||i,n||function(t){return e.outEdges(t)})}function o(e,t,n){var r={},i=e.nodes();return i.forEach(function(e){r[e]={},r[e][e]={distance:0},i.forEach(function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})}),n(e).forEach(function(n){var i=n.v===e?n.w:n.v,s=t(n);r[e][i]={distance:s,predecessor:e}})}),i.forEach(function(e){var t=r[e];i.forEach(function(n){var s=r[n];i.forEach(function(n){var r=s[e],i=t[n],o=s[n],u=r.distance+i.distance;u<o.distance&&(o.distance=u,o.predecessor=i.predecessor)})})}),r}var r=e("../lodash");t.exports=s;var i=r.constant(1)},{"../lodash":49}],38:[function(e,t,n){t.exports={components:e("./components"),dijkstra:e("./dijkstra"),dijkstraAll:e("./dijkstra-all"),findCycles:e("./find-cycles"),floydWarshall:e("./floyd-warshall"),isAcyclic:e("./is-acyclic"),postorder:e("./postorder"),preorder:e("./preorder"),prim:e("./prim"),tarjan:e("./tarjan"),topsort:e("./topsort")}},{"./components":32,"./dijkstra":35,"./dijkstra-all":34,"./find-cycles":36,"./floyd-warshall":37,"./is-acyclic":39,"./postorder":40,"./preorder":41,"./prim":42,"./tarjan":43,"./topsort":44}],39:[function(e,t,n){function i(e){try{r(e)}catch(t){if(t instanceof r.CycleException)return!1;throw t}return!0}var r=e("./topsort");t.exports=i},{"./topsort":44}],40:[function(e,t,n){function i(e,t){return r(e,t,"post")}var r=e("./dfs");t.exports=i},{"./dfs":33}],41:[function(e,t,n){function i(e,t){return r(e,t,"pre")}var r=e("./dfs");t.exports=i},{"./dfs":33}],42:[function(e,t,n){function o(e,t){function f(e){var n=e.v===a?e.w:e.v,r=u.priority(n);if(r!==undefined){var i=t(e);i<r&&(o[n]=a,u.decrease(n,i))}}var n=new i,o={},u=new s,a;if(e.nodeCount()===0)return n;r.each(e.nodes(),function(e){u.add(e,Number.POSITIVE_INFINITY),n.setNode(e)}),u.decrease(e.nodes()[0],0);var l=!1;while(u.size()>0){a=u.removeMin();if(r.has(o,a))n.setEdge(a,o[a]);else{if(l)throw new Error("Input graph is not connected: "+e);l=!0}e.nodeEdges(a).forEach(f)}return n}var r=e("../lodash"),i=e("../graph"),s=e("../data/priority-queue");t.exports=o},{"../data/priority-queue":45,"../graph":46,"../lodash":49}],43:[function(e,t,n){function i(e){function o(u){var a=i[u]={onStack:!0,lowlink:t,index:t++};n.push(u),e.successors(u).forEach(function(e){r.has(i,e)?i[e].onStack&&(a.lowlink=Math.min(a.lowlink,i[e].index)):(o(e),a.lowlink=Math.min(a.lowlink,i[e].lowlink))});if(a.lowlink===a.index){var f=[],l;do l=n.pop(),i[l].onStack=!1,f.push(l);while(u!==l);s.push(f)}}var t=0,n=[],i={},s=[];return e.nodes().forEach(function(e){r.has(i,e)||o(e)}),s}var r=e("../lodash");t.exports=i},{"../lodash":49}],44:[function(e,t,n){function i(e){function o(u){if(r.has(n,u))throw new s;r.has(t,u)||(n[u]=!0,t[u]=!0,r.each(e.predecessors(u),o),delete n[u],i.push(u))}var t={},n={},i=[];r.each(e.sinks(),o);if(r.size(t)!==e.nodeCount())throw new s;return i}function s(){}var r=e("../lodash");t.exports=i,i.CycleException=s},{"../lodash":49}],45:[function(e,t,n){function i(){this._arr=[],this._keyIndices={}}var r=e("../lodash");t.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map(function(e){return e.key})},i.prototype.has=function(e){return r.has(this._keyIndices,e)},i.prototype.priority=function(e){var t=this._keyIndices[e];if(t!==undefined)return this._arr[t].priority},i.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(e,t){var n=this._keyIndices;e=String(e);if(!r.has(n,e)){var i=this._arr,s=i.length;return n[e]=s,i.push({key:e,priority:t}),this._decrease(s),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},i.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},i.prototype._heapify=function(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))},i.prototype._decrease=function(e){var t=this._arr,n=t[e].priority,r;while(e!==0){r=e>>1;if(t[r].priority<n)break;this._swap(e,r),e=r}},i.prototype._swap=function(e,t){var n=this._arr,r=this._keyIndices,i=n[e],s=n[t];n[e]=s,n[t]=i,r[s.key]=e,r[i.key]=t}},{"../lodash":49}],46:[function(e,t,n){"use strict";function u(e){this._isDirected=r.has(e,"directed")?e.directed:!0,this._isMultigraph=r.has(e,"multigraph")?e.multigraph:!1,this._isCompound=r.has(e,"compound")?e.compound:!1,this._label=undefined,this._defaultNodeLabelFn=r.constant(undefined),this._defaultEdgeLabelFn=r.constant(undefined),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[s]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function a(e,t){r.has(e,t)?e[t]++:e[t]=1}function f(e,t){--e[t]||delete e[t]}function l(e,t,n,s){if(!e&&t>n){var u=t;t=n,n=u}return t+o+n+o+(r.isUndefined(s)?i:s)}function c(e,t,n,r){if(!e&&t>n){var i=t;t=n,n=i}var s={v:t,w:n};return r&&(s.name=r),s}function h(e,t){return l(e,t.v,t.w,t.name)}var r=e("./lodash");t.exports=u;var i="\0",s="\0",o="";u.prototype._nodeCount=0,u.prototype._edgeCount=0,u.prototype.isDirected=function(){return this._isDirected},u.prototype.isMultigraph=function(){return this._isMultigraph},u.prototype.isCompound=function(){return this._isCompound},u.prototype.setGraph=function(e){return this._label=e,this},u.prototype.graph=function(){return this._label},u.prototype.setDefaultNodeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultNodeLabelFn=e,this},u.prototype.nodeCount=function(){return this._nodeCount},u.prototype.nodes=function(){return r.keys(this._nodes)},u.prototype.sources=function(){return r.filter(this.nodes(),function(e){return r.isEmpty(this._in[e])},this)},u.prototype.sinks=function(){return r.filter(this.nodes(),function(e){return r.isEmpty(this._out[e])},this)},u.prototype.setNodes=function(e,t){var n=arguments;return r.each(e,function(e){n.length>1?this.setNode(e,t):this.setNode(e)},this),this},u.prototype.setNode=function(e,t){return r.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=s,this._children[e]={},this._children[s][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},u.prototype.node=function(e){return this._nodes[e]},u.prototype.hasNode=function(e){return r.has(this._nodes,e)},u.prototype.removeNode=function(e){var t=this;if(r.has(this._nodes,e)){var n=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],r.each(this.children(e),function(e){this.setParent(e)},this),delete this._children[e]),r.each(r.keys(this._in[e]),n),delete this._in[e],delete this._preds[e],r.each(r.keys(this._out[e]),n),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},u.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(r.isUndefined(t))t=s;else{t+="";for(var n=t;!r.isUndefined(n);n=this.parent(n))if(n===e)throw new Error("Setting "+t+" as parent of "+e+" would create create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},u.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},u.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==s)return t}},u.prototype.children=function(e){r.isUndefined(e)&&(e=s);if(this._isCompound){var t=this._children[e];if(t)return r.keys(t)}else{if(e===s)return this.nodes();if(this.hasNode(e))return[]}},u.prototype.predecessors=function(e){var t=this._preds[e];if(t)return r.keys(t)},u.prototype.successors=function(e){var t=this._sucs[e];if(t)return r.keys(t)},u.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return r.union(t,this.successors(e))},u.prototype.setDefaultEdgeLabel=function(e){return r.isFunction(e)||(e=r.constant(e)),this._defaultEdgeLabelFn=e,this},u.prototype.edgeCount=function(){return this._edgeCount},u.prototype.edges=function(){return r.values(this._edgeObjs)},u.prototype.setPath=function(e,t){var n=this,i=arguments;return r.reduce(e,function(e,r){return i.length>1?n.setEdge(e,r,t):n.setEdge(e,r),r}),this},u.prototype.setEdge=function(){var e,t,n,i,s=!1;r.isPlainObject(arguments[0])?(e=arguments[0].v,t=arguments[0].w,n=arguments[0].name,arguments.length===2&&(i=arguments[1],s=!0)):(e=arguments[0],t=arguments[1],n=arguments[3],arguments.length>2&&(i=arguments[2],s=!0)),e=""+e,t=""+t,r.isUndefined(n)||(n=""+n);var o=l(this._isDirected,e,t,n);if(r.has(this._edgeLabels,o))return s&&(this._edgeLabels[o]=i),this;if(!r.isUndefined(n)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[o]=s?i:this._defaultEdgeLabelFn(e,t,n);var u=c(this._isDirected,e,t,n);return e=u.v,t=u.w,Object.freeze(u),this._edgeObjs[o]=u,a(this._preds[t],e),a(this._sucs[e],t),this._in[t][o]=u,this._out[e][o]=u,this._edgeCount++,this},u.prototype.edge=function(e,t,n){var r=arguments.length===1?h(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return this._edgeLabels[r]},u.prototype.hasEdge=function(e,t,n){var i=arguments.length===1?h(this._isDirected,arguments[0]):l(this._isDirected,e,t,n);return r.has(this._edgeLabels,i)},u.prototype.removeEdge=function(e,t,n){var r=arguments.length===1?h(this._isDirected,arguments[0]):l(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],f(this._preds[t],e),f(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this},u.prototype.inEdges=function(e,t){var n=this._in[e];if(n){var i=r.values(n);return t?r.filter(i,function(e){return e.v===t}):i}},u.prototype.outEdges=function(e,t){var n=this._out[e];if(n){var i=r.values(n);return t?r.filter(i,function(e){return e.w===t}):i}},u.prototype.nodeEdges=function(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}},{"./lodash":49}],47:[function(e,t,n){t.exports={Graph:e("./graph"),version:e("./version")}},{"./graph":46,"./version":50}],48:[function(e,t,n){function s(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:o(e),edges:u(e)};return r.isUndefined(e.graph())||(t.value=r.clone(e.graph())),t}function o(e){return r.map(e.nodes(),function(t){var n=e.node(t),i=e.parent(t),s={v:t};return r.isUndefined(n)||(s.value=n),r.isUndefined(i)||(s.parent=i),s})}function u(e){return r.map(e.edges(),function(t){var n=e.edge(t),i={v:t.v,w:t.w};return r.isUndefined(t.name)||(i.name=t.name),r.isUndefined(n)||(i.value=n),i})}function a(e){var t=(new i(e.options)).setGraph(e.value);return r.each(e.nodes,function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)}),r.each(e.edges,function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)}),t}var r=e("./lodash"),i=e("./graph");t.exports={write:s,read:a}},{"./graph":46,"./lodash":49}],49:[function(e,t,n){var r;if(typeof e=="function")try{r=e("lodash")}catch(i){}r||(r=window._),t.exports=r},{lodash:51}],50:[function(e,t,n){t.exports="1.0.5"},{}],51:[function(t,n,r){(function(t){(function(){function Bt(e,t){if(e!==t){var n=e===null,r=e===i,s=e===e,o=t===null,u=t===i,a=t===t;if(e>t&&!o||!s||n&&!u&&a||r&&a)return 1;if(e<t&&!n||!a||o&&!r&&s||u&&s)return-1}return 0}function jt(e,t,n){var r=e.length,i=n?r:-1;while(n?i--:++i<r)if(t(e[i],i,e))return i;return-1}function Ft(e,t,n){if(t!==t)return Kt(e,n);var r=n-1,i=e.length;while(++r<i)if(e[r]===t)return r;return-1}function It(e){return typeof e=="function"||!1}function qt(e){return e==null?"":e+""}function Rt(e,t){var n=-1,r=e.length;while(++n<r&&t.indexOf(e.charAt(n))>-1);return n}function Ut(e,t){var n=e.length;while(n--&&t.indexOf(e.charAt(n))>-1);return n}function zt(e,t){return Bt(e.criteria,t.criteria)||e.index-t.index}function Wt(e,t,n){var r=-1,i=e.criteria,s=t.criteria,o=i.length,u=n.length;while(++r<o){var a=Bt(i[r],s[r]);if(a){if(r>=u)return a;var f=n[r];return a*(f==="asc"||f===!0?1:-1)}}return e.index-t.index}function Xt(e){return xt[e]}function Vt(e){return Tt[e]}function $t(e,t,n){return t?e=kt[e]:n&&(e=Lt[e]),"\\"+e}function Jt(e){return"\\"+Lt[e]}function Kt(e,t,n){var r=e.length,i=t+(n?0:-1);while(n?i--:++i<r){var s=e[i];if(s!==s)return i}return-1}function Qt(e){return!!e&&typeof e=="object"}function Gt(e){return e<=160&&e>=9&&e<=13||e==32||e==160||e==5760||e==6158||e>=8192&&(e<=8202||e==8232||e==8233||e==8239||e==8287||e==12288||e==65279)}function Yt(e,t){var n=-1,r=e.length,i=-1,s=[];while(++n<r)e[n]===t&&(e[n]=x,s[++i]=n);return s}function Zt(e,t){var n,r=-1,i=e.length,s=-1,o=[];while(++r<i){var u=e[r],a=t?t(u,r,e):u;if(!r||n!==a)n=a,o[++s]=u}return o}function en(e){var t=-1,n=e.length;while(++t<n&&Gt(e.charCodeAt(t)));return t}function tn(e){var t=e.length;while(t--&&Gt(e.charCodeAt(t)));return t}function nn(e){return Nt[e]}function rn(e){function Hn(e){if(Qt(e)&&!mu(e)&&!(e instanceof In)){if(e instanceof jn)return e;if(Mt.call(e,"__chain__")&&Mt.call(e,"__wrapped__"))return gs(e)}return new jn(e)}function Bn(){}function jn(e,t,n){this.__wrapped__=e,this.__actions__=n||[],this.__chain__=!!t}function In(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ln,this.__views__=[]}function qn(){var e=new In(this.__wrapped__);return e.__actions__=Yn(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Yn(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Yn(this.__views__),e}function Rn(){if(this.__filtered__){var e=new In(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Un(){var e=this.__wrapped__.value(),t=this.__dir__,n=mu(e),r=t<0,i=n?e.length:0,s=Ki(0,i,this.__views__),o=s.start,u=s.end,a=u-o,f=r?u:o-1,l=this.__iteratees__,c=l.length,h=0,p=xn(a,this.__takeCount__);if(!n||i<b||i==a&&p==a)return ii(r&&n?e.reverse():e,this.__actions__);var d=[];e:while(a--&&h<p){f+=t;var v=-1,m=e[f];while(++v<c){var g=l[v],y=g.iteratee,S=g.type,x=y(m);if(S==E)m=x;else if(!x){if(S==w)continue e;break e}}d[h++]=m}return d}function zn(){this.__data__={}}function Wn(e){return this.has(e)&&delete this.__data__[e]}function Xn(e){return e=="__proto__"?i:this.__data__[e]}function Vn(e){return e!="__proto__"&&Mt.call(this.__data__,e)}function $n(e,t){return e!="__proto__"&&(this.__data__[e]=t),this}function Jn(e){var t=e?e.length:0;this.data={hash:gn(null),set:new cn};while(t--)this.push(e[t])}function Kn(e,t){var n=e.data,r=typeof t=="string"||Nu(t)?n.set.has(t):n.hash[t];return r?0:-1}function Qn(e){var t=this.data;typeof e=="string"||Nu(e)?t.set.add(e):t.hash[e]=!0}function Gn(e,n){var r=-1,i=e.length,s=-1,o=n.length,u=t(i+o);while(++r<i)u[r]=e[r];while(++s<o)u[r++]=n[s];return u}function Yn(e,n){var r=-1,i=e.length;n||(n=t(i));while(++r<i)n[r]=e[r];return n}function Zn(e,t){var n=-1,r=e.length;while(++n<r)if(t(e[n],n,e)===!1)break;return e}function er(e,t){var n=e.length;while(n--)if(t(e[n],n,e)===!1)break;return e}function tr(e,t){var n=-1,r=e.length;while(++n<r)if(!t(e[n],n,e))return!1;return!0}function nr(e,t,n,r){var i=-1,s=e.length,o=r,u=o;while(++i<s){var a=e[i],f=+t(a);n(f,o)&&(o=f,u=a)}return u}function rr(e,t){var n=-1,r=e.length,i=-1,s=[];while(++n<r){var o=e[n];t(o,n,e)&&(s[++i]=o)}return s}function ir(e,n){var r=-1,i=e.length,s=t(i);while(++r<i)s[r]=n(e[r],r,e);return s}function sr(e,t){var n=-1,r=t.length,i=e.length;while(++n<r)e[i+n]=t[n];return e}function or(e,t,n,r){var i=-1,s=e.length;r&&s&&(n=e[++i]);while(++i<s)n=t(n,e[i],i,e);return n}function ur(e,t,n,r){var i=e.length;r&&i&&(n=e[--i]);while(i--)n=t(n,e[i],i,e);return n}function ar(e,t){var n=-1,r=e.length;while(++n<r)if(t(e[n],n,e))return!0;return!1}function fr(e,t){var n=e.length,r=0;while(n--)r+=+t(e[n])||0;return r}function lr(e,t){return e===i?t:e}function cr(e,t,n,r){return e===i||!Mt.call(r,n)?t:e}function hr(e,t,n){var r=-1,s=ta(t),o=s.length;while(++r<o){var u=s[r],a=e[u],f=n(a,t[u],u,e,t);if((f===f?f!==a:a===a)||a===i&&!(u in e))e[u]=f}return e}function pr(e,t){return t==null?e:vr(t,ta(t),e)}function dr(e,n){var r=-1,s=e==null,o=!s&&es(e),u=o?e.length:0,a=n.length,f=t(a);while(++r<a){var l=n[r];o?f[r]=ts(l,u)?e[l]:i:f[r]=s?i:e[l]}return f}function vr(e,t,n){n||(n={});var r=-1,i=t.length;while(++r<i){var s=t[r];n[s]=e[s]}return n}function mr(e,t,n){var r=typeof e;return r=="function"?t===i?e:ui(e,t,n):e==null?qa:r=="object"?qr(e):t===i?Ja(e):Rr(e,t)}function gr(e,t,n,r,s,o,u){var a;n&&(a=s?n(e,r,s):n(e));if(a!==i)return a;if(!Nu(e))return e;var f=mu(e);if(f){a=Qi(e);if(!t)return Yn(e,a)}else{var l=Dt.call(e),c=l==A;if(!(l==_||l==T||c&&!s))return St[l]?Yi(e,l,t):s?e:{};a=Gi(c?{}:e);if(!t)return pr(a,e)}o||(o=[]),u||(u=[]);var h=o.length;while(h--)if(o[h]==e)return u[h];return o.push(e),u.push(a),(f?Zn:_r)(e,function(r,i){a[i]=gr(r,t,n,i,e,o,u)}),a}function br(e,t,n){if(typeof e!="function")throw new Ct(S);return hn(function(){e.apply(i,n)},t)}function wr(e,t){var n=e?e.length:0,r=[];if(!n)return r;var i=-1,s=Xi(),o=s==Ft,u=o&&t.length>=b?mi(t):null,a=t.length;u&&(s=Kn,o=!1,t=u);e:while(++i<n){var f=e[i];if(o&&f===f){var l=a;while(l--)if(t[l]===f)continue e;r.push(f)}else s(t,f,0)<0&&r.push(f)}return r}function xr(e,t){var n=!0;return Er(e,function(e,r,i){return n=!!t(e,r,i),n}),n}function Tr(e,t,n,r){var i=r,s=i;return Er(e,function(e,o,u){var a=+t(e,o,u);if(n(a,i)||a===r&&a===s)i=a,s=e}),s}function Nr(e,t,n,r){var s=e.length;n=n==null?0:+n||0,n<0&&(n=-n>s?0:s+n),r=r===i||r>s?s:+r||0,r<0&&(r+=s),s=n>r?0:r>>>0,n>>>=0;while(n<s)e[n++]=t;return e}function Cr(e,t){var n=[];return Er(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function kr(e,t,n,r){var i;return n(e,function(e,n,s){if(t(e,n,s))return i=r?n:e,!1}),i}function Lr(e,t,n,r){r||(r=[]);var i=-1,s=e.length;while(++i<s){var o=e[i];Qt(o)&&es(o)&&(n||mu(o)||vu(o))?t?Lr(o,t,n,r):sr(r,o):n||(r[r.length]=o)}return r}function Mr(e,t){return Ar(e,t,na)}function _r(e,t){return Ar(e,t,ta)}function Dr(e,t){return Or(e,t,ta)}function Pr(e,t){var n=-1,r=t.length,i=-1,s=[];while(++n<r){var o=t[n];Tu(e[o])&&(s[++i]=o)}return s}function Hr(e,t,n){if(e==null)return;n!==i&&n in vs(e)&&(t=[n]);var r=0,s=t.length;while(e!=null&&r<s)e=e[t[r++]];return r&&r==s?e:i}function Br(e,t,n,r,i,s){return e===t?!0:e==null||t==null||!Nu(e)&&!Qt(t)?e!==e&&t!==t:jr(e,t,Br,n,r,i,s)}function jr(e,t,n,r,i,s,o){var u=mu(e),a=mu(t),f=N,l=N;u||(f=Dt.call(e),f==T?f=_:f!=_&&(u=Pu(e))),a||(l=Dt.call(t),l==T?l=_:l!=_&&(a=Pu(t)));var c=f==_,h=l==_,p=f==l;if(p&&!u&&!c)return qi(e,t,f);if(!i){var d=c&&Mt.call(e,"__wrapped__"),v=h&&Mt.call(t,"__wrapped__");if(d||v)return n(d?e.value():e,v?t.value():t,r,i,s,o)}if(!p)return!1;s||(s=[]),o||(o=[]);var m=s.length;while(m--)if(s[m]==e)return o[m]==t;s.push(e),o.push(t);var g=(u?Ii:Ri)(e,t,n,r,i,s,o);return s.pop(),o.pop(),g}function Fr(e,t,n){var r=t.length,s=r,o=!n;if(e==null)return!s;e=vs(e);while(r--){var u=t[r];if(o&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}while(++r<s){u=t[r];var a=u[0],f=e[a],l=u[1];if(o&&u[2]){if(f===i&&!(a in e))return!1}else{var c=n?n(f,l,a):i;if(c===i?!Br(l,f,n,!0):!c)return!1}}return!0}function Ir(e,n){var r=-1,i=es(e)?t(e.length):[];return Er(e,function(e,t,s){i[++r]=n(e,t,s)}),i}function qr(e){var t=$i(e);if(t.length==1&&t[0][2]){var n=t[0][0],r=t[0][1];return function(e){return e==null?!1:e[n]===r&&(r!==i||n in vs(e))}}return function(e){return Fr(e,t)}}function Rr(e,t){var n=mu(e),r=rs(e)&&os(t),s=e+"";return e=ms(e),function(o){if(o==null)return!1;var u=s;o=vs(o);if((n||!r)&&!(u in o)){o=e.length==1?o:Hr(o,Qr(e,0,-1));if(o==null)return!1;u=Ps(e),o=vs(o)}return o[u]===t?t!==i||u in o:Br(t,o[u],i,!0)}}function Ur(e,t,n,r,s){if(!Nu(e))return e;var o=es(t)&&(mu(t)||Pu(t)),u=o?i:ta(t);return Zn(u||t,function(a,f){u&&(f=a,a=t[f]);if(Qt(a))r||(r=[]),s||(s=[]),zr(e,t,f,Ur,n,r,s);else{var l=e[f],c=n?n(l,a,f,e,t):i,h=c===i;h&&(c=a),(c!==i||o&&!(f in e))&&(h||(c===c?c!==l:l===l))&&(e[f]=c)}}),e}function zr(e,t,n,r,s,o,u){var a=o.length,f=t[n];while(a--)if(o[a]==f){e[n]=u[a];return}var l=e[n],c=s?s(l,f,n,e,t):i,h=c===i;h&&(c=f,es(f)&&(mu(f)||Pu(f))?c=mu(l)?l:es(l)?Yn(l):[]:Mu(f)||vu(f)?c=vu(l)?Iu(l):Mu(l)?l:{}:h=!1),o.push(f),u.push(c);if(h)e[n]=r(c,f,s,o,u);else if(c===c?c!==l:l===l)e[n]=c}function Wr(e){return function(t){return t==null?i:t[e]}}function Xr(e){var t=e+"";return e=ms(e),function(n){return Hr(n,e,t)}}function Vr(e,t){var n=e?t.length:0;while(n--){var r=t[n];if(r!=i&&ts(r)){var i=r;pn.call(e,r,1)}}return e}function $r(e,t){return e+yn(Cn()*(t-e+1))}function Jr(e,t,n,r,i){return i(e,function(e,i,s){n=r?(r=!1,e):t(n,e,i,s)}),n}function Qr(e,n,r){var s=-1,o=e.length;n=n==null?0:+n||0,n<0&&(n=-n>o?0:o+n),r=r===i||r>o?o:+r||0,r<0&&(r+=o),o=n>r?0:r-n>>>0,n>>>=0;var u=t(o);while(++s<o)u[s]=e[s+n];return u}function Gr(e,t){var n;return Er(e,function(e,r,i){return n=t(e,r,i),!n}),!!n}function Yr(e,t){var n=e.length;e.sort(t);while(n--)e[n]=e[n].value;return e}function Zr(e,t,n){var r=Ui(),i=-1;t=ir(t,function(e){return r(e)});var s=Ir(e,function(e){var n=ir(t,function(t){return t(e)});return{criteria:n,index:++i,value:e}});return Yr(s,function(e,t){return Wt(e,t,n)})}function ei(e,t){var n=0;return Er(e,function(e,r,i){n+=+t(e,r,i)||0}),n}function ti(e,t){var n=-1,r=Xi(),i=e.length,s=r==Ft,o=s&&i>=b,u=o?mi():null,a=[];u?(r=Kn,s=!1):(o=!1,u=t?[]:a);e:while(++n<i){var f=e[n],l=t?t(f,n,e):f;if(s&&f===f){var c=u.length;while(c--)if(u[c]===l)continue e;t&&u.push(l),a.push(f)}else r(u,l,0)<0&&((t||o)&&u.push(l),a.push(f))}return a}function ni(e,n){var r=-1,i=n.length,s=t(i);while(++r<i)s[r]=e[n[r]];return s}function ri(e,t,n,r){var i=e.length,s=r?i:-1;while((r?s--:++s<i)&&t(e[s],s,e));return n?Qr(e,r?0:s,r?s+1:i):Qr(e,r?s+1:0,r?i:s)}function ii(e,t){var n=e;n instanceof In&&(n=n.value());var r=-1,i=t.length;while(++r<i){var s=t[r];n=s.func.apply(s.thisArg,sr([n],s.args))}return n}function si(e,t,n){var r=0,i=e?e.length:r;if(typeof t=="number"&&t===t&&i<=Mn){while(r<i){var s=r+i>>>1,o=e[s];(n?o<=t:o<t)&&o!==null?r=s+1:i=s}return i}return oi(e,t,qa,n)}function oi(e,t,n,r){t=n(t);var s=0,o=e?e.length:0,u=t!==t,a=t===null,f=t===i;while(s<o){var l=yn((s+o)/2),c=n(e[l]),h=c!==i,p=c===c;if(u)var d=p||r;else a?d=p&&h&&(r||c!=null):f?d=p&&(r||h):c==null?d=!1:d=r?c<=t:c<t;d?s=l+1:o=l}return xn(o,On)}function ui(e,t,n){if(typeof e!="function")return qa;if(t===i)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,r,i){return e.call(t,n,r,i)};case 4:return function(n,r,i,s){return e.call(t,n,r,i,s)};case 5:return function(n,r,i,s,o){return e.call(t,n,r,i,s,o)}}return function(){return e.apply(t,arguments)}}function ai(e){var t=new on(e.byteLength),n=new dn(t);return n.set(new dn(e)),t}function fi(e,n,r){var i=r.length,s=-1,o=Sn(e.length-i,0),u=-1,a=n.length,f=t(a+o);while(++u<a)f[u]=n[u];while(++s<i)f[r[s]]=e[s];while(o--)f[u++]=e[s++];return f}function li(e,n,r){var i=-1,s=r.length,o=-1,u=Sn(e.length-s,0),a=-1,f=n.length,l=t(u+f);while(++o<u)l[o]=e[o];var c=o;while(++a<f)l[c+a]=n[a];while(++i<s)l[c+r[i]]=e[o++];return l}function ci(e,t){return function(n,r,i){var s=t?t():{};r=Ui(r,i,3);if(mu(n)){var o=-1,u=n.length;while(++o<u){var a=n[o];e(s,a,r(a,o,n),n)}}else Er(n,function(t,n,i){e(s,t,r(t,n,i),i)});return s}}function hi(e){return uu(function(t,n){var r=-1,s=t==null?0:n.length,o=s>2?n[s-2]:i,u=s>2?n[2]:i,a=s>1?n[s-1]:i;typeof o=="function"?(o=ui(o,a,5),s-=2):(o=typeof a=="function"?a:i,s-=o?1:0),u&&ns(n[0],n[1],u)&&(o=s<3?i:o,s=1);while(++r<s){var f=n[r];f&&e(t,f,o)}return t})}function pi(e,t){return function(n,r){var i=n?Vi(n):0;if(!ss(i))return e(n,r);var s=t?i:-1,o=vs(n);while(t?s--:++s<i)if(r(o[s],s,o)===!1)break;return n}}function di(e){return function(t,n,r){var i=vs(t),s=r(t),o=s.length,u=e?o:-1;while(e?u--:++u<o){var a=s[u];if(n(i[a],a,i)===!1)break}return t}}function vi(e,t){function r(){var i=this&&this!==Ht&&this instanceof r?n:e;return i.apply(t,arguments)}var n=yi(e);return r}function mi(e){return gn&&cn?new Jn(e):null}function gi(e){return function(t){var n=-1,r=Ba(ga(t)),i=r.length,s="";while(++n<i)s=e(s,r[n],n);return s}}function yi(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=yr(e.prototype),r=e.apply(n,t);return Nu(r)?r:n}}function bi(e){function t(n,r,s){s&&ns(n,r,s)&&(r=i);var o=Fi(n,e,i,i,i,i,i,r);return o.placeholder=t.placeholder,o}return t}function wi(e,t){return uu(function(n){var r=n[0];return r==null?r:(n.push(t),e.apply(i,n))})}function Ei(e,t){return function(n,r,s){s&&ns(n,r,s)&&(r=i),r=Ui(r,s,3);if(r.length==1){n=mu(n)?n:ds(n);var o=nr(n,r,e,t);if(!n.length||o!==t)return o}return Tr(n,r,e,t)}}function Si(e,t){return function(n,r,s){r=Ui(r,s,3);if(mu(n)){var o=jt(n,r,t);return o>-1?n[o]:i}return kr(n,r,e)}}function xi(e){return function(t,n,r){return!t||!t.length?-1:(n=Ui(n,r,3),jt(t,n,e))}}function Ti(e){return function(t,n,r){return n=Ui(n,r,3),kr(t,n,e,!0)}}function Ni(e){return function(){var n,r=arguments.length,s=e?r:-1,o=0,u=t(r);while(e?s--:++s<r){var a=u[o++]=arguments[s];if(typeof a!="function")throw new Ct(S);!n&&jn.prototype.thru&&Wi(a)=="wrapper"&&(n=new jn([],!0))}s=n?-1:r;while(++s<r){a=u[s];var l=Wi(a),h=l=="wrapper"?zi(a):i;h&&is(h[0])&&h[1]==(p|f|c|d)&&!h[4].length&&h[9]==1?n=n[Wi(h[0])].apply(n,h[3]):n=a.length==1&&is(a)?n[l]():n.thru(a)}return function(){var e=arguments,t=e[0];if(n&&e.length==1&&mu(t)&&t.length>=b)return n.plant(t).value();var i=0,s=r?u[i].apply(this,e):t;while(++i<r)s=u[i].call(this,s);return s}}}function Ci(e,t){return function(n,r,s){return typeof r=="function"&&s===i&&mu(n)?e(n,r):t(n,ui(r,s,3))}}function ki(e){return function(t,n,r){if(typeof n!="function"||r!==i)n=ui(n,r,3);return e(t,n,na)}}function Li(e){return function(t,n,r){if(typeof n!="function"||r!==i)n=ui(n,r,3);return e(t,n)}}function Ai(e){return function(t,n,r){var i={};return n=Ui(n,r,3),_r(t,function(t,r,s){var o=n(t,r,s);r=e?o:r,t=e?t:o,i[r]=t}),i}}function Oi(e){return function(t,n,r){return t=qt(t),(e?t:"")+Pi(t,n,r)+(e?"":t)}}function Mi(e){var t=uu(function(n,r){var s=Yt(r,t.placeholder);return Fi(n,e,i,r,s)});return t}function _i(e,t){return function(n,r,s,o){var u=arguments.length<3;return typeof r=="function"&&o===i&&mu(n)?e(n,r,s,u):Jr(n,Ui(r,o,4),s,u,t)}}function Di(e,n,r,s,d,v,m,g,y,b){function k(){var a=arguments.length,f=a,l=t(a);while(f--)l[f]=arguments[f];s&&(l=fi(l,s,d)),v&&(l=li(l,v,m));if(x||N){var p=k.placeholder,L=Yt(l,p);a-=L.length;if(a<b){var A=g?Yn(g):i,O=Sn(b-a,0),M=x?L:i,_=x?i:L,D=x?l:i,P=x?i:l;n|=x?c:h,n&=~(x?h:c),T||(n&=~(o|u));var H=[e,n,r,D,M,P,_,A,y,O],B=Di.apply(i,H);return is(e)&&hs(B,H),B.placeholder=p,B}}var j=E?r:this,F=S?j[e]:e;return g&&(l=cs(l,g)),w&&y<l.length&&(l.length=y),this&&this!==Ht&&this instanceof k&&(F=C||yi(e)),F.apply(j,l)}var w=n&p,E=n&o,S=n&u,x=n&f,T=n&a,N=n&l,C=S?i:yi(e);return k}function Pi(e,t,n){var r=e.length;t=+t;if(r>=t||!wn(t))return"";var i=t-r;return n=n==null?" ":n+"",Ca(n,mn(i/n.length)).slice(0,i)}function Hi(e,n,r,i){function a(){var n=-1,o=arguments.length,f=-1,l=i.length,c=t(l+o);while(++f<l)c[f]=i[f];while(o--)c[f++]=arguments[++n];var h=this&&this!==Ht&&this instanceof a?u:e;return h.apply(s?r:this,c)}var s=n&o,u=yi(e);return a}function Bi(e){var t=P[e];return function(e,n){return n=n===i?0:+n||0,n?(n=fn(10,n),t(e*n)/n):t(e)}}function ji(e){return function(t,n,r,i){var s=Ui(r);return r==null&&s===mr?si(t,n,e):oi(t,n,s(r,i,1),e)}}function Fi(e,t,n,r,s,a,f,l){var p=t&u;if(!p&&typeof e!="function")throw new Ct(S);var d=r?r.length:0;d||(t&=~(c|h),r=s=i),d-=s?s.length:0;if(t&h){var v=r,m=s;r=s=i}var g=p?i:zi(e),y=[e,t,n,r,s,v,m,a,f,l];g&&(us(y,g),t=y[1],l=y[9]),y[9]=l==null?p?0:e.length:Sn(l-d,0)||0;if(t==o)var b=vi(y[0],y[2]);else t!=c&&t!=(o|c)||!!y[4].length?b=Di.apply(i,y):b=Hi.apply(i,y);var w=g?Kr:hs;return w(b,y)}function Ii(e,t,n,r,s,o,u){var a=-1,f=e.length,l=t.length;if(f!=l&&!(s&&l>f))return!1;while(++a<f){var c=e[a],h=t[a],p=r?r(s?h:c,s?c:h,a):i;if(p!==i){if(p)continue;return!1}if(s){if(!ar(t,function(e){return c===e||n(c,e,r,s,o,u)}))return!1}else if(c!==h&&!n(c,h,r,s,o,u))return!1}return!0}function qi(e,t,n){switch(n){case C:case k:return+e==+t;case L:return e.name==t.name&&e.message==t.message;case M:return e!=+e?t!=+t:e==+t;case D:case H:return e==t+""}return!1}function Ri(e,t,n,r,s,o,u){var a=ta(e),f=a.length,l=ta(t),c=l.length;if(f!=c&&!s)return!1;var h=f;while(h--){var p=a[h];if(!(s?p in t:Mt.call(t,p)))return!1}var d=s;while(++h<f){p=a[h];var v=e[p],m=t[p],g=r?r(s?m:v,s?v:m,p):i;if(g===i?!n(v,m,r,s,o,u):!g)return!1;d||(d=p=="constructor")}if(!d){var y=e.constructor,b=t.constructor;if(y!=b&&"constructor"in e&&"constructor"in t&&!(typeof y=="function"&&y instanceof y&&typeof b=="function"&&b instanceof b))return!1}return!0}function Ui(e,t,n){var r=Hn.callback||Fa;return r=r===Fa?mr:r,n?r(e,t,n):r}function Wi(e){var t=e.name,n=Pn[t],r=n?n.length:0;while(r--){var i=n[r],s=i.func;if(s==null||s==e)return i.name}return t}function Xi(e,t,n){var r=Hn.indexOf||Ms;return r=r===Ms?Ft:r,e?r(e,t,n):r}function $i(e){var t=oa(e),n=t.length;while(n--)t[n][2]=os(t[n][1]);return t}function Ji(e,t){var n=e==null?i:e[t];return Lu(n)?n:i}function Ki(e,t,n){var r=-1,i=n.length;while(++r<i){var s=n[r],o=s.size;switch(s.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=xn(t,e+o);break;case"takeRight":e=Sn(e,t-o)}}return{start:e,end:t}}function Qi(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&Mt.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function Gi(e){var t=e.constructor;return typeof t=="function"&&t instanceof t||(t=xt),new t}function Yi(e,t,n){var r=e.constructor;switch(t){case j:return ai(e);case C:case k:return new r(+e);case F:case I:case q:case R:case U:case z:case W:case X:case V:var i=e.buffer;return new r(n?ai(i):i,e.byteOffset,e.length);case M:case H:return new r(e);case D:var s=new r(e.source,ct.exec(e));s.lastIndex=e.lastIndex}return s}function Zi(e,t,n){e!=null&&!rs(t,e)&&(t=ms(t),e=t.length==1?e:Hr(e,Qr(t,0,-1)),t=Ps(t));var r=e==null?e:e[t];return r==null?i:r.apply(e,n)}function es(e){return e!=null&&ss(Vi(e))}function ts(e,t){return e=typeof e=="number"||dt.test(e)?+e:-1,t=t==null?_n:t,e>-1&&e%1==0&&e<t}function ns(e,t,n){if(!Nu(n))return!1;var r=typeof t;if(r=="number"?es(n)&&ts(t,n.length):r=="string"&&t in n){var i=n[t];return e===e?e===i:i!==i}return!1}function rs(e,t){var n=typeof e;if(n=="string"&&it.test(e)||n=="number")return!0;if(mu(e))return!1;var r=!rt.test(e);return r||t!=null&&e in vs(t)}function is(e){var t=Wi(e);if(t in In.prototype){var n=Hn[t];if(e===n)return!0;var r=zi(n);return!!r&&e===r[0]}return!1}function ss(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=_n}function os(e){return e===e&&!Nu(e)}function us(e,t){var n=e[1],r=t[1],i=n|r,s=i<p,u=r==p&&n==f||r==p&&n==d&&e[7].length<=t[8]||r==(p|d)&&n==f;if(!s&&!u)return e;r&o&&(e[2]=t[2],i|=n&o?0:a);var l=t[3];if(l){var c=e[3];e[3]=c?fi(c,l,t[4]):Yn(l),e[4]=c?Yt(e[3],x):Yn(t[4])}return l=t[5],l&&(c=e[5],e[5]=c?li(c,l,t[6]):Yn(l),e[6]=c?Yt(e[5],x):Yn(t[6])),l=t[7],l&&(e[7]=Yn(l)),r&p&&(e[8]=e[8]==null?t[8]:xn(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=i,e}function as(e,t){return e===i?t:qu(e,t,as)}function fs(e,t){e=vs(e);var n=-1,r=t.length,i={};while(++n<r){var s=t[n];s in e&&(i[s]=e[s])}return i}function ls(e,t){var n={};return Mr(e,function(e,r,i){t(e,r,i)&&(n[r]=e)}),n}function cs(e,t){var n=e.length,r=xn(t.length,n),s=Yn(e);while(r--){var o=t[r];e[r]=ts(o,n)?s[o]:i}return e}function ps(e){var t=na(e),n=t.length,r=n&&e.length,i=!!r&&ss(r)&&(mu(e)||vu(e)),s=-1,o=[];while(++s<n){var u=t[s];(i&&ts(u,r)||Mt.call(e,u))&&o.push(u)}return o}function ds(e){return e==null?[]:es(e)?Nu(e)?e:xt(e):ca(e)}function vs(e){return Nu(e)?e:xt(e)}function ms(e){if(mu(e))return e;var t=[];return qt(e).replace(st,function(e,n,r,i){t.push(r?i.replace(ft,"$1"):n||e)}),t}function gs(e){return e instanceof In?e.clone():new jn(e.__wrapped__,e.__chain__,Yn(e.__actions__))}function ys(e,n,r){(r?ns(e,n,r):n==null)?n=1:n=Sn(yn(n)||1,1);var i=0,s=e?e.length:0,o=-1,u=t(mn(s/n));while(i<s)u[++o]=Qr(e,i,i+=n);return u}function bs(e){var t=-1,n=e?e.length:0,r=-1,i=[];while(++t<n){var s=e[t];s&&(i[++r]=s)}return i}function Es(e,t,n){var r=e?e.length:0;if(!r)return[];if(n?ns(e,t,n):t==null)t=1;return Qr(e,t<0?0:t)}function Ss(e,t,n){var r=e?e.length:0;if(!r)return[];if(n?ns(e,t,n):t==null)t=1;return t=r-(+t||0),Qr(e,0,t<0?0:t)}function xs(e,t,n){return e&&e.length?ri(e,Ui(t,n,3),!0,!0):[]}function Ts(e,t,n){return e&&e.length?ri(e,Ui(t,n,3),!0):[]}function Ns(e,t,n,r){var i=e?e.length:0;return i?(n&&typeof n!="number"&&ns(e,t,n)&&(n=0,r=i),Nr(e,t,n,r)):[]}function Ls(e){return e?e[0]:i}function As(e,t,n){var r=e?e.length:0;return n&&ns(e,t,n)&&(t=!1),r?Lr(e,t):[]}function Os(e){var t=e?e.length:0;return t?Lr(e,!0):[]}function Ms(e,t,n){var r=e?e.length:0;if(!r)return-1;if(typeof n=="number")n=n<0?Sn(r+n,0):n;else if(n){var i=si(e,t);return i<r&&(t===t?t===e[i]:e[i]!==e[i])?i:-1}return Ft(e,t,n||0)}function _s(e){return Ss(e,1)}function Ps(e){var t=e?e.length:0;return t?e[t-1]:i}function Hs(e,t,n){var r=e?e.length:0;if(!r)return-1;var i=r;if(typeof n=="number")i=(n<0?Sn(r+n,0):xn(n||0,r-1))+1;else if(n){i=si(e,t,!0)-1;var s=e[i];return(t===t?t===s:s!==s)?i:-1}if(t!==t)return Kt(e,i,!0);while(i--)if(e[i]===t)return i;return-1}function Bs(){var e=arguments,t=e[0];if(!t||!t.length)return t;var n=0,r=Xi(),i=e.length;while(++n<i){var s=0,o=e[n];while((s=r(t,o,s))>-1)pn.call(t,s,1)}return t}function Fs(e,t,n){var r=[];if(!e||!e.length)return r;var i=-1,s=[],o=e.length;t=Ui(t,n,3);while(++i<o){var u=e[i];t(u,i,e)&&(r.push(u),s.push(i))}return Vr(e,s),r}function Is(e){return Es(e,1)}function qs(e,t,n){var r=e?e.length:0;return r?(n&&typeof n!="number"&&ns(e,t,n)&&(t=0,n=r),Qr(e,t,n)):[]}function zs(e,t,n){var r=e?e.length:0;if(!r)return[];if(n?ns(e,t,n):t==null)t=1;return Qr(e,0,t<0?0:t)}function Ws(e,t,n){var r=e?e.length:0;if(!r)return[];if(n?ns(e,t,n):t==null)t=1;return t=r-(+t||0),Qr(e,t<0?0:t)}function Xs(e,t,n){return e&&e.length?ri(e,Ui(t,n,3),!1,!0):[]}function Vs(e,t,n){return e&&e.length?ri(e,Ui(t,n,3)):[]}function Js(e,t,n,r){var s=e?e.length:0;if(!s)return[];t!=null&&typeof t!="boolean"&&(r=n,n=ns(e,t,r)?i:t,t=!1);var o=Ui();if(n!=null||o!==mr)n=o(n,r,3);return t&&Xi()==Ft?Zt(e,n):ti(e,n)}function Ks(e){if(!e||!e.length)return[];var n=-1,r=0;e=rr(e,function(e){if(es(e))return r=Sn(e.length,r),!0});var i=t(r);while(++n<r)i[n]=ir(e,Wr(n));return i}function Qs(e,t,n){var r=e?e.length:0;if(!r)return[];var s=Ks(e);return t==null?s:(t=ui(t,n,4),ir(s,function(e){return or(e,t,i,!0)}))}function Ys(){var e=-1,t=arguments.length;while(++e<t){var n=arguments[e];if(es(n))var r=r?sr(wr(r,n),wr(n,r)):n}return r?ti(r):[]}function eo(e,t){var n=-1,r=e?e.length:0,i={};r&&!t&&!mu(e[0])&&(t=[]);while(++n<r){var s=e[n];t?i[s]=t[n]:s&&(i[s[0]]=s[1])}return i}function no(e){var t=Hn(e);return t.__chain__=!0,t}function ro(e,t,n){return t.call(n,e),e}function io(e,t,n){return t.call(n,e)}function so(){return no(this)}function oo(){return new jn(this.value(),this.__chain__)}function ao(e){var t,n=this;while(n instanceof Bn){var r=gs(n);t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t}function fo(){var e=this.__wrapped__,t=function(e){return n&&n.__dir__<0?e:e.reverse()};if(e instanceof In){var n=e;return this.__actions__.length&&(n=new In(this)),n=n.reverse(),n.__actions__.push({func:io,args:[t],thisArg:i}),new jn(n,this.__chain__)}return this.thru(t)}function lo(){return this.value()+""}function co(){return ii(this.__wrapped__,this.__actions__)}function vo(e,t,n){var r=mu(e)?tr:xr;n&&ns(e,t,n)&&(t=i);if(typeof t!="function"||n!==i)t=Ui(t,n,3);return r(e,t)}function mo(e,t,n){var r=mu(e)?rr:Cr;return t=Ui(t,n,3),r(e,t)}function bo(e,t){return go(e,qr(t))}function xo(e,t,n,r){var i=e?Vi(e):0;return ss(i)||(e=ca(e),i=e.length),typeof n!="number"||r&&ns(t,n,r)?n=0:n=n<0?Sn(i+n,0):n||0,typeof e=="string"||!mu(e)&&Du(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&Xi(e,t,n)>-1}function Co(e,t,n){var r=mu(e)?ir:Ir;return t=Ui(t,n,3),r(e,t)}function Lo(e,t){return Co(e,Ja(t))}function Mo(e,t,n){var r=mu(e)?rr:Cr;return t=Ui(t,n,3),r(e,function(e,n,r){return!t(e,n,r)})}function _o(e,t,n){if(n?ns(e,t,n):t==null){e=ds(e);var r=e.length;return r>0?e[$r(0,r-1)]:i}var s=-1,o=Fu(e),r=o.length,u=r-1;t=xn(t<0?0:+t||0,r);while(++s<t){var a=$r(s,u),f=o[a];o[a]=o[s],o[s]=f}return o.length=t,o}function Do(e){return _o(e,Ln)}function Po(e){var t=e?Vi(e):0;return ss(t)?t:ta(e).length}function Ho(e,t,n){var r=mu(e)?ar:Gr;n&&ns(e,t,n)&&(t=i);if(typeof t!="function"||n!==i)t=Ui(t,n,3);return r(e,t)}function Bo(e,t,n){if(e==null)return[];n&&ns(e,t,n)&&(t=i);var r=-1;t=Ui(t,n,3);var s=Ir(e,function(e,n,i){return{criteria:t(e,n,i),index:++r,value:e}});return Yr(s,zt)}function Fo(e,t,n,r){return e==null?[]:(r&&ns(t,n,r)&&(n=i),mu(t)||(t=t==null?[]:[t]),mu(n)||(n=n==null?[]:[n]),Zr(e,t,n))}function Io(e,t){return mo(e,qr(t))}function Ro(e,t){if(typeof t!="function"){if(typeof e!="function")throw new Ct(S);var n=e;e=t,t=n}return e=wn(e=+e)?e:0,function(){if(--e<1)return t.apply(this,arguments)}}function Uo(e,t,n){return n&&ns(e,t,n)&&(t=i),t=e&&t==null?e.length:Sn(+t||0,0),Fi(e,p,i,i,i,i,t)}function zo(e,t){var n;if(typeof t!="function"){if(typeof e!="function")throw new Ct(S);var r=e;e=t,t=r}return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}function Ko(e,t,n){function v(){f&&un(f),s&&un(s),c=0,s=f=l=i}function m(t,n){n&&un(n),s=f=l=i,t&&(c=qo(),o=e.apply(a,r),!f&&!s&&(r=a=i))}function g(){var e=t-(qo()-u);e<=0||e>t?m(l,s):f=hn(g,e)}function y(){m(p,f)}function b(){r=arguments,u=qo(),a=this,l=p&&(f||!d);if(h===!1)var n=d&&!f;else{!s&&!d&&(c=u);var v=h-(u-c),m=v<=0||v>h;m?(s&&(s=un(s)),c=u,o=e.apply(a,r)):s||(s=hn(y,v))}return m&&f?f=un(f):!f&&t!==h&&(f=hn(g,t)),n&&(m=!0,o=e.apply(a,r)),m&&!f&&!s&&(r=a=i),o}var r,s,o,u,a,f,l,c=0,h=!1,p=!0;if(typeof e!="function")throw new Ct(S);t=t<0?0:+t||0;if(n===!0){var d=!0;p=!1}else Nu(n)&&(d=!!n.leading,h="maxWait"in n&&Sn(+n.maxWait||0,t),p="trailing"in n?!!n.trailing:p);return b.cancel=v,b}function eu(e,t){if(typeof e!="function"||t&&typeof t!="function")throw new Ct(S);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=e.apply(this,r);return n.cache=s.set(i,o),o};return n.cache=new eu.Cache,n}function nu(e){if(typeof e!="function")throw new Ct(S);return function(){return!e.apply(this,arguments)}}function ru(e){return zo(2,e)}function uu(e,n){if(typeof e!="function")throw new Ct(S);return n=Sn(n===i?e.length-1:+n||0,0),function(){var r=arguments,i=-1,s=Sn(r.length-n,0),o=t(s);while(++i<s)o[i]=r[n+i];switch(n){case 0:return e.call(this,o);case 1:return e.call(this,r[0],o);case 2:return e.call(this,r[0],r[1],o)}var u=t(n+1);i=-1;while(++i<n)u[i]=r[i];return u[n]=o,e.apply(this,u)}}function au(e){if(typeof e!="function")throw new Ct(S);return function(t){return e.apply(this,t)}}function fu(e,t,n){var r=!0,i=!0;if(typeof e!="function")throw new Ct(S);return n===!1?r=!1:Nu(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ko(e,t,{leading:r,maxWait:+t,trailing:i})}function lu(e,t){return t=t==null?qa:t,Fi(t,c,i,[e],[])}function cu(e,t,n,r){return t&&typeof t!="boolean"&&ns(e,t,n)?t=!1:typeof t=="function"&&(r=n,n=t,t=!1),typeof n=="function"?gr(e,t,ui(n,r,1)):gr(e,t)}function hu(e,t,n){return typeof t=="function"?gr(e,!0,ui(t,n,1)):gr(e,!0)}function pu(e,t){return e>t}function du(e,t){return e>=t}function vu(e){return Qt(e)&&es(e)&&Mt.call(e,"callee")&&!ln.call(e,"callee")}function gu(e){return e===!0||e===!1||Qt(e)&&Dt.call(e)==C}function yu(e){return Qt(e)&&Dt.call(e)==k}function bu(e){return!!e&&e.nodeType===1&&Qt(e)&&!Mu(e)}function wu(e){return e==null?!0:es(e)&&(mu(e)||Du(e)||vu(e)||Qt(e)&&Tu(e.splice))?!e.length:!ta(e).length}function Eu(e,t,n,r){n=typeof n=="function"?ui(n,r,3):i;var s=n?n(e,t):i;return s===i?Br(e,t,n):!!s}function Su(e){return Qt(e)&&typeof e.message=="string"&&Dt.call(e)==L}function xu(e){return typeof e=="number"&&wn(e)}function Tu(e){return Nu(e)&&Dt.call(e)==A}function Nu(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Cu(e,t,n,r){return n=typeof n=="function"?ui(n,r,3):i,Fr(e,$i(t),n)}function ku(e){return Ou(e)&&e!=+e}function Lu(e){return e==null?!1:Tu(e)?Gt.test(Ot.call(e)):Qt(e)&&pt.test(e)}function Au(e){return e===null}function Ou(e){return typeof e=="number"||Qt(e)&&Dt.call(e)==M}function Mu(e){var t;if(!Qt(e)||Dt.call(e)!=_||!!vu(e)||!Mt.call(e,"constructor")&&(t=e.constructor,typeof t=="function"&&!(t instanceof t)))return!1;var n;return Mr(e,function(e,t){n=t}),n===i||Mt.call(e,n)}function _u(e){return Nu(e)&&Dt.call(e)==D}function Du(e){return typeof e=="string"||Qt(e)&&Dt.call(e)==H}function Pu(e){return Qt(e)&&ss(e.length)&&!!Et[Dt.call(e)]}function Hu(e){return e===i}function Bu(e,t){return e<t}function ju(e,t){return e<=t}function Fu(e){var t=e?Vi(e):0;return ss(t)?t?Yn(e):[]:ca(e)}function Iu(e){return vr(e,na(e))}function Uu(e,t,n){var r=yr(e);return n&&ns(e,t,n)&&(t=i),t?pr(r,t):r}function Gu(e){return Pr(e,na(e))}function Yu(e,t,n){var r=e==null?i:Hr(e,ms(t),t+"");return r===i?n:r}function Zu(e,t){if(e==null)return!1;var n=Mt.call(e,t);if(!n&&!rs(t)){t=ms(t),e=t.length==1?e:Hr(e,Qr(t,0,-1));if(e==null)return!1;t=Ps(t),n=Mt.call(e,t)}return n||ss(e.length)&&ts(t,e.length)&&(mu(e)||vu(e))}function ea(e,t,n){n&&ns(e,t,n)&&(t=i);var r=-1,s=ta(e),o=s.length,u={};while(++r<o){var a=s[r],f=e[a];t?Mt.call(u,f)?u[f].push(a):u[f]=[a]:u[f]=a}return u}function na(e){if(e==null)return[];Nu(e)||(e=xt(e));var n=e.length;n=n&&ss(n)&&(mu(e)||vu(e))&&n||0;var r=e.constructor,i=-1,s=typeof r=="function"&&r.prototype===e,o=t(n),u=n>0;while(++i<n)o[i]=i+"";for(var a in e)(!u||!ts(a,n))&&(a!="constructor"||!s&&!!Mt.call(e,a))&&o.push(a);return o}function oa(e){e=vs(e);var n=-1,r=ta(e),i=r.length,s=t(i);while(++n<i){var o=r[n];s[n]=[o,e[o]]}return s}function aa(e,t,n){var r=e==null?i:e[t];return r===i&&(e!=null&&!rs(t,e)&&(t=ms(t),e=t.length==1?e:Hr(e,Qr(t,0,-1)),r=e==null?i:e[Ps(t)]),r=r===i?n:r),Tu(r)?r.call(e):r}function fa(e,t,n){if(e==null)return e;var r=t+"";t=e[r]!=null||rs(t,e)?[r]:ms(t);var i=-1,s=t.length,o=s-1,u=e;while(u!=null&&++i<s){var a=t[i];Nu(u)&&(i==o?u[a]=n:u[a]==null&&(u[a]=ts(t[i+1])?[]:{})),u=u[a]}return e}function la(e,t,n,r){var s=mu(e)||Pu(e);t=Ui(t,r,4);if(n==null)if(s||Nu(e)){var o=e.constructor;s?n=mu(e)?new o:[]:n=yr(Tu(o)?o.prototype:i)}else n={};return(s?Zn:_r)(e,function(e,r,i){return t(n,e,r,i)}),n}function ca(e){return ni(e,ta(e))}function ha(e){return ni(e,na(e))}function pa(e,t,n){return t=+t||0,n===i?(n=t,t=0):n=+n||0,e>=xn(t,n)&&e<Sn(t,n)}function da(e,t,n){n&&ns(e,t,n)&&(t=n=i);var r=e==null,s=t==null;n==null&&(s&&typeof e=="boolean"?(n=e,e=1):typeof t=="boolean"&&(n=t,s=!0)),r&&s&&(t=1,s=!1),e=+e||0,s?(t=e,e=0):t=+t||0;if(n||e%1||t%1){var o=Cn();return xn(e+o*(t-e+an("1e-"+((o+"").length-1))),t)}return $r(e,t)}function ma(e){return e=qt(e),e&&e.charAt(0).toUpperCase()+e.slice(1)}function ga(e){return e=qt(e),e&&e.replace(vt,Xt).replace(at,"")}function ya(e,t,n){e=qt(e),t+="";var r=e.length;return n=n===i?r:xn(n<0?0:+n||0,r),n-=t.length,n>=0&&e.indexOf(t,n)==n}function ba(e){return e=qt(e),e&&Z.test(e)?e.replace(G,Vt):e}function wa(e){return e=qt(e),e&&ut.test(e)?e.replace(ot,$t):e||"(?:)"}function Sa(e,t,n){e=qt(e),t=+t;var r=e.length;if(r>=t||!wn(t))return e;var i=(t-r)/2,s=yn(i),o=mn(i);return n=Pi("",o,n),n.slice(0,s)+e+n}function Na(e,t,n){return(n?ns(e,t,n):t==null)?t=0:t&&(t=+t),e=Ma(e),Nn(e,t||(ht.test(e)?16:10))}function Ca(e,t){var n="";e=qt(e),t=+t;if(t<1||!e||!wn(t))return n;do t%2&&(n+=e),t=yn(t/2),e+=e;while(t);return n}function Aa(e,t,n){return e=qt(e),n=n==null?0:xn(n<0?0:+n||0,e.length),e.lastIndexOf(t,n)==n}function Oa(e,t,n){var r=Hn.templateSettings;n&&ns(e,t,n)&&(t=n=i),e=qt(e),t=hr(pr({},n||t),r,cr);var s=hr(pr({},t.imports),r.imports,cr),o=ta(s),u=ni(s,o),a,f,l=0,c=t.interpolate||mt,h="__p += '",p=Tt((t.escape||mt).source+"|"+c.source+"|"+(c===nt?lt:mt).source+"|"+(t.evaluate||mt).source+"|$","g"),d="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++wt+"]")+"\n";e.replace(p,function(t,n,r,i,s,o){return r||(r=i),h+=e.slice(l,o).replace(gt,Jt),n&&(a=!0,h+="' +\n__e("+n+") +\n'"),s&&(f=!0,h+="';\n"+s+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=o+t.length,t}),h+="';\n";var v=t.variable;v||(h="with (obj) {\n"+h+"\n}\n"),h=(f?h.replace($,""):h).replace(J,"$1").replace(K,"$1;"),h="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(a?", __e = _.escape":"")+(f?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=ja(function(){return O(o,d+"return "+h).apply(i,u)});m.source=h;if(Su(m))throw m;return m}function Ma(e,t,n){var r=e;return e=qt(e),e?(n?ns(r,t,n):t==null)?e.slice(en(e),tn(e)+1):(t+="",e.slice(Rt(e,t),Ut(e,t)+1)):e}function _a(e,t,n){var r=e;return e=qt(e),e?(n?ns(r,t,n):t==null)?e.slice(en(e)):e.slice(Rt(e,t+"")):e}function Da(e,t,n){var r=e;return e=qt(e),e?(n?ns(r,t,n):t==null)?e.slice(0,tn(e)+1):e.slice(0,Ut(e,t+"")+1):e}function Pa(e,t,n){n&&ns(e,t,n)&&(t=i);var r=v,s=m;if(t!=null)if(Nu(t)){var o="separator"in t?t.separator:o;r="length"in t?+t.length||0:r,s="omission"in t?qt(t.omission):s}else r=+t||0;e=qt(e);if(r>=e.length)return e;var u=r-s.length;if(u<1)return s;var a=e.slice(0,u);if(o==null)return a+s;if(_u(o)){if(e.slice(u).search(o)){var f,l,c=e.slice(0,u);o.global||(o=Tt(o.source,(ct.exec(o)||"")+"g")),o.lastIndex=0;while(f=o.exec(c))l=f.index;a=a.slice(0,l==null?u:l)}}else if(e.indexOf(o,u)!=u){var h=a.lastIndexOf(o);h>-1&&(a=a.slice(0,h))}return a+s}function Ha(e){return e=qt(e),e&&Y.test(e)?e.replace(Q,nn):e}function Ba(e,t,n){return n&&ns(e,t,n)&&(t=i),e=qt(e),e.match(t||yt)||[]}function Fa(e,t,n){return n&&ns(e,t,n)&&(t=i),Qt(e)?Ra(e):mr(e,t)}function Ia(e){return function(){return e}}function qa(e){return e}function Ra(e){return qr(gr(e,!0))}function Ua(e,t){return Rr(e,gr(t,!0))}function Xa(e,t,n){if(n==null){var r=Nu(t),s=r?ta(t):i,o=s&&s.length?Pr(t,s):i;if(o?!o.length:!r)o=!1,n=t,t=e,e=this}o||(o=Pr(t,ta(t)));var u=!0,a=-1,f=Tu(e),l=o.length;n===!1?u=!1:Nu(n)&&"chain"in n&&(u=n.chain);while(++a<l){var c=o[a],h=t[c];e[c]=h,f&&(e.prototype[c]=function(t){return function(){var n=this.__chain__;if(u||n){var r=e(this.__wrapped__),i=r.__actions__=Yn(this.__actions__);return i.push({func:t,args:arguments,thisArg:e}),r.__chain__=n,r}return t.apply(e,sr([this.value()],arguments))}}(h))}return e}function Va(){return Ht._=Pt,this}function $a(){}function Ja(e){return rs(e)?Wr(e):Xr(e)}function Ka(e){return function(t){return Hr(e,ms(t),t+"")}}function Qa(e,n,r){r&&ns(e,n,r)&&(n=r=i),e=+e||0,r=r==null?1:+r||0,n==null?(n=e,e=0):n=+n||0;var s=-1,o=Sn(mn((n-e)/(r||1)),0),u=t(o);while(++s<o)u[s]=e,e+=r;return u}function Ga(e,n,r){e=yn(e);if(e<1||!wn(e))return[];var i=-1,s=t(xn(e,An));n=ui(n,r,1);while(++i<e)i<An?s[i]=n(i):n(i);return s}function Ya(e){var t=++_t;return qt(e)+t}function Za(e,t){return(+e||0)+(+t||0)}function of(e,t,n){return n&&ns(e,t,n)&&(t=i),t=Ui(t,n,3),t.length==1?fr(mu(e)?e:ds(e),t):ei(e,t)}e=e?sn.defaults(Ht.Object(),e,sn.pick(Ht,bt)):Ht;var t=e.Array,n=e.Date,r=e.Error,O=e.Function,P=e.Math,B=e.Number,xt=e.Object,Tt=e.RegExp,Nt=e.String,Ct=e.TypeError,kt=t.prototype,Lt=xt.prototype,At=Nt.prototype,Ot=O.prototype.toString,Mt=Lt.hasOwnProperty,_t=0,Dt=Lt.toString,Pt=Ht._,Gt=Tt("^"+Ot.call(Mt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),on=e.ArrayBuffer,un=e.clearTimeout,an=e.parseFloat,fn=P.pow,ln=Lt.propertyIsEnumerable,cn=Ji(e,"Set"),hn=e.setTimeout,pn=kt.splice,dn=e.Uint8Array,vn=Ji(e,"WeakMap"),mn=P.ceil,gn=Ji(xt,"create"),yn=P.floor,bn=Ji(t,"isArray"),wn=e.isFinite,En=Ji(xt,"keys"),Sn=P.max,xn=P.min,Tn=Ji(n,"now"),Nn=e.parseInt,Cn=P.random,kn=B.NEGATIVE_INFINITY,Ln=B.POSITIVE_INFINITY,An=4294967295,On=An-1,Mn=An>>>1,_n=9007199254740991,Dn=vn&&new vn,Pn={},Fn=Hn.support={};Hn.templateSettings={escape:et,evaluate:tt,interpolate:nt,variable:"",imports:{_:Hn}};var yr=function(){function e(){}return function(t){if(Nu(t)){e.prototype=t;var n=new e;e.prototype=i}return n||{}}}(),Er=pi(_r),Sr=pi(Dr,!0),Ar=di(),Or=di(!0),Kr=Dn?function(e,t){return Dn.set(e,t),e}:qa,zi=Dn?function(e){return Dn.get(e)}:$a,Vi=Wr("length"),hs=function(){var e=0,t=0;return function(n,r){var i=qo(),s=y-(i-t);t=i;if(s>0){if(++e>=g)return n}else e=0;return Kr(n,r)}}(),ws=uu(function(e,t){return Qt(e)&&es(e)?wr(e,Lr(t,!1,!0)):[]}),Cs=xi(),ks=xi(!0),Ds=uu(function(e){var n=e.length,r=n,i=t(c),s=Xi(),o=s==Ft,u=[];while(r--){var a=e[r]=es(a=e[r])?a:[];i[r]=o&&a.length>=120?mi(r&&a):null}var f=e[0],l=-1,c=f?f.length:0,h=i[0];e:while(++l<c){a=f[l];if((h?Kn(h,a):s(u,a,0))<0){var r=n;while(--r){var p=i[r];if((p?Kn(p,a):s(e[r],a,0))<0)continue e}h&&h.push(a),u.push(a)}}return u}),js=uu(function(e,t){t=Lr(t);var n=dr(e,t);return Vr(e,t.sort(Bt)),n}),Rs=ji(),Us=ji(!0),$s=uu(function(e){return ti(Lr(e,!1,!0))}),Gs=uu(function(e,t){return es(e)?wr(e,t):[]}),Zs=uu(Ks),to=uu(function(e){var t=e.length,n=t>2?e[t-2]:i,r=t>1?e[t-1]:i;return t>2&&typeof n=="function"?t-=2:(n=t>1&&typeof r=="function"?(--t,r):i,r=i),e.length=t,Qs(e,n,r)}),uo=uu(function(e){return e=Lr(e),this.thru(function(t){return Gn(mu(t)?t:[vs(t)],e)})}),ho=uu(function(e,t){return dr(e,Lr(t))}),po=ci(function(e,t,n){Mt.call(e,n)?++e[n]:e[n]=1}),go=Si(Er),yo=Si(Sr,!0),wo=Ci(Zn,Er),Eo=Ci(er,Sr),So=ci(function(e,t,n){Mt.call(e,n)?e[n].push(t):e[n]=[t]}),To=ci(function(e,t,n){e[n]=t}),No=uu(function(e,n,r){var s=-1,o=typeof n=="function",u=rs(n),a=es(e)?t(e.length):[];return Er(e,function(e){var t=o?n:u&&e!=null?e[n]:i;a[++s]=t?t.apply(e,r):Zi(e,n,r)}),a}),ko=ci(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]}),Ao=_i(or,Er),Oo=_i(ur,Sr),jo=uu(function(e,t){if(e==null)return[];var n=t[2];return n&&ns(t[0],t[1],n)&&(t.length=1),Zr(e,Lr(t),[])}),qo=Tn||function(){return(new n).getTime()},Wo=uu(function(e,t,n){var r=o;if(n.length){var i=Yt(n,Wo.placeholder);r|=c}return Fi(e,r,t,n,i)}),Xo=uu(function(e,t){t=t.length?Lr(t):Gu(e);var n=-1,r=t.length;while(++n<r){var i=t[n];e[i]=Fi(e[i],o,e)}return e}),Vo=uu(function(e,t,n){var r=o|u;if(n.length){var i=Yt(n,Vo.placeholder);r|=c}return Fi(t,r,e,n,i)}),$o=bi(f),Jo=bi(l),Qo=uu(function(e,t){return br(e,1,t)}),Go=uu(function(e,t,n){return br(e,t,n)}),Yo=Ni(),Zo=Ni(!0),tu=uu(function(e,t){t=Lr(t);if(typeof e!="function"||!tr(t,It))throw new Ct(S);var n=t.length;return uu(function(r){var i=xn(r.length,n);while(i--)r[i]=t[i](r[i]);return e.apply(this,r)})}),iu=Mi(c),su=Mi(h),ou=uu(function(e,t){return Fi(e,d,i,i,i,Lr(t))}),mu=bn||function(e){return Qt(e)&&ss(e.length)&&Dt.call(e)==N},qu=hi(Ur),Ru=hi(function(e,t,n){return n?hr(e,t,n):pr(e,t)}),zu=wi(Ru,lr),Wu=wi(qu,as),Xu=Ti(_r),Vu=Ti(Dr),$u=ki(Ar),Ju=ki(Or),Ku=Li(_r),Qu=Li(Dr),ta=En?function(e){var t=e==null?i:e.constructor;return typeof t=="function"&&t.prototype===e||typeof e!="function"&&es(e)?ps(e):Nu(e)?En(e):[]}:ps,ra=Ai(!0),ia=Ai(),sa=uu(function(e,t){if(e==null)return{};if(typeof t[0]!="function"){var t=ir(Lr(t),Nt);return fs(e,wr(na(e),t))}var n=ui(t[0],t[1],3);return ls(e,function(e,t,r){return!n(e,t,r)})}),ua=uu(function(e,t){return e==null?{}:typeof t[0]=="function"?ls(e,ui(t[0],t[1],3)):fs(e,Lr(t))}),va=gi(function(e,t,n){return t=t.toLowerCase(),e+(n?t.charAt(0).toUpperCase()+t.slice(1):t)}),Ea=gi(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),xa=Oi(),Ta=Oi(!0),ka=gi(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),La=gi(function(e,t,n){return e+(n?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),ja=uu(function(e,t){try{return e.apply(i,t)}catch(n){return Su(n)?n:new r(n)}}),za=uu(function(e,t){return function(n){return Zi(n,e,t)}}),Wa=uu(function(e,t){return function(n){return Zi(e,n,t)}}),ef=Bi("ceil"),tf=Bi("floor"),nf=Ei(pu,kn),rf=Ei(Bu,Ln),sf=Bi("round");return Hn.prototype=Bn.prototype,jn.prototype=yr(Bn.prototype),jn.prototype.constructor=jn,In.prototype=yr(Bn.prototype),In.prototype.constructor=In,zn.prototype["delete"]=Wn,zn.prototype.get=Xn,zn.prototype.has=Vn,zn.prototype.set=$n,Jn.prototype.push=Qn,eu.Cache=zn,Hn.after=Ro,Hn.ary=Uo,Hn.assign=Ru,Hn.at=ho,Hn.before=zo,Hn.bind=Wo,Hn.bindAll=Xo,Hn.bindKey=Vo,Hn.callback=Fa,Hn.chain=no,Hn.chunk=ys,Hn.compact=bs,Hn.constant=Ia,Hn.countBy=po,Hn.create=Uu,Hn.curry=$o,Hn.curryRight=Jo,Hn.debounce=Ko,Hn.defaults=zu,Hn.defaultsDeep=Wu,Hn.defer=Qo,Hn.delay=Go,Hn.difference=ws,Hn.drop=Es,Hn.dropRight=Ss,Hn.dropRightWhile=xs,Hn.dropWhile=Ts,Hn.fill=Ns,Hn.filter=mo,Hn.flatten=As,Hn.flattenDeep=Os,Hn.flow=Yo,Hn.flowRight=Zo,Hn.forEach=wo,Hn.forEachRight=Eo,Hn.forIn=$u,Hn.forInRight=Ju,Hn.forOwn=Ku,Hn.forOwnRight=Qu,Hn.functions=Gu,Hn.groupBy=So,Hn.indexBy=To,Hn.initial=_s,Hn.intersection=Ds,Hn.invert=ea,Hn.invoke=No,Hn.keys=ta,Hn.keysIn=na,Hn.map=Co,Hn.mapKeys=ra,Hn.mapValues=ia,Hn.matches=Ra,Hn.matchesProperty=Ua,Hn.memoize=eu,Hn.merge=qu,Hn.method=za,Hn.methodOf=Wa,Hn.mixin=Xa,Hn.modArgs=tu,Hn.negate=nu,Hn.omit=sa,Hn.once=ru,Hn.pairs=oa,Hn.partial=iu,Hn.partialRight=su,Hn.partition=ko,Hn.pick=ua,Hn.pluck=Lo,Hn.property=Ja,Hn.propertyOf=Ka,Hn.pull=Bs,Hn.pullAt=js,Hn.range=Qa,Hn.rearg=ou,Hn.reject=Mo,Hn.remove=Fs,Hn.rest=Is,Hn.restParam=uu,Hn.set=fa,Hn.shuffle=Do,Hn.slice=qs,Hn.sortBy=Bo,Hn.sortByAll=jo,Hn.sortByOrder=Fo,Hn.spread=au,Hn.take=zs,Hn.takeRight=Ws,Hn.takeRightWhile=Xs,Hn.takeWhile=Vs,Hn.tap=ro,Hn.throttle=fu,Hn.thru=io,Hn.times=Ga,Hn.toArray=Fu,Hn.toPlainObject=Iu,Hn.transform=la,Hn.union=$s,Hn.uniq=Js,Hn.unzip=Ks,Hn.unzipWith=Qs,Hn.values=ca,Hn.valuesIn=ha,Hn.where=Io,Hn.without=Gs,Hn.wrap=lu,Hn.xor=Ys,Hn.zip=Zs,Hn.zipObject=eo,Hn.zipWith=to,Hn.backflow=Zo,Hn.collect=Co,Hn.compose=Zo,Hn.each=wo,Hn.eachRight=Eo,Hn.extend=Ru,Hn.iteratee=Fa,Hn.methods=Gu,Hn.object=eo,Hn.select=mo,Hn.tail=Is,Hn.unique=Js,Xa(Hn,Hn),Hn.add=Za,Hn.attempt=ja,Hn.camelCase=va,Hn.capitalize=ma,Hn.ceil=ef,Hn.clone=cu,Hn.cloneDeep=hu,Hn.deburr=ga,Hn.endsWith=ya,Hn.escape=ba,Hn.escapeRegExp=wa,Hn.every=vo,Hn.find=go,Hn.findIndex=Cs,Hn.findKey=Xu,Hn.findLast=yo,Hn.findLastIndex=ks,Hn.findLastKey=Vu,Hn.findWhere=bo,Hn.first=Ls,Hn.floor=tf,Hn.get=Yu,Hn.gt=pu,Hn.gte=du,Hn.has=Zu,Hn.identity=qa,Hn.includes=xo,Hn.indexOf=Ms,Hn.inRange=pa,Hn.isArguments=vu,Hn.isArray=mu,Hn.isBoolean=gu,Hn.isDate=yu,Hn.isElement=bu,Hn.isEmpty=wu,Hn.isEqual=Eu,Hn.isError=Su,Hn.isFinite=xu,Hn.isFunction=Tu,Hn.isMatch=Cu,Hn.isNaN=ku,Hn.isNative=Lu,Hn.isNull=Au,Hn.isNumber=Ou,Hn.isObject=Nu,Hn.isPlainObject=Mu,Hn.isRegExp=_u,Hn.isString=Du,Hn.isTypedArray=Pu,Hn.isUndefined=Hu,Hn.kebabCase=Ea,Hn.last=Ps,Hn.lastIndexOf=Hs,Hn.lt=Bu,Hn.lte=ju,Hn.max=nf,Hn.min=rf,Hn.noConflict=Va,Hn.noop=$a,Hn.now=qo,Hn.pad=Sa,Hn.padLeft=xa,Hn.padRight=Ta,Hn.parseInt=Na,Hn.random=da,Hn.reduce=Ao,Hn.reduceRight=Oo,Hn.repeat=Ca,Hn.result=aa,Hn.round=sf,Hn.runInContext=rn,Hn.size=Po,Hn.snakeCase=ka,Hn.some=Ho,Hn.sortedIndex=Rs,Hn.sortedLastIndex=Us,Hn.startCase=La,Hn.startsWith=Aa,Hn.sum=of,Hn.template=Oa,Hn.trim=Ma,Hn.trimLeft=_a,Hn.trimRight=Da,Hn.trunc=Pa,Hn.unescape=Ha,Hn.uniqueId=Ya,Hn.words=Ba,Hn.all=vo,Hn.any=Ho,Hn.contains=xo,Hn.eq=Eu,Hn.detect=go,Hn.foldl=Ao,Hn.foldr=Oo,Hn.head=Ls,Hn.include=xo,Hn.inject=Ao,Xa(Hn,function(){var e={};return _r(Hn,function(t,n){Hn.prototype[n]||(e[n]=t)}),e}(),!1),Hn.sample=_o,Hn.prototype.sample=function(e){return!this.__chain__&&e==null?_o(this.value()):this.thru(function(t){return _o(t,e)})},Hn.VERSION=s,Zn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){Hn[e].placeholder=Hn}),Zn(["drop","take"],function(e,t){In.prototype[e]=function(n){var r=this.__filtered__;if(r&&!t)return new In(this);n=n==null?1:Sn(yn(n)||0,0);var i=this.clone();return r?i.__takeCount__=xn(i.__takeCount__,n):i.__views__.push({size:n,type:e+(i.__dir__<0?"Right":"")}),i},In.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Zn(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n!=E;In.prototype[e]=function(e,t){var i=this.clone();return i.__iteratees__.push({iteratee:Ui(e,t,1),type:n}),i.__filtered__=i.__filtered__||r,i}}),Zn(["first","last"],function(e,t){var n="take"+(t?"Right":"");In.prototype[e]=function(){return this[n](1).value()[0]}}),Zn(["initial","rest"],function(e,t){var n="drop"+(t?"":"Right");In.prototype[e]=function(){return this.__filtered__?new In(this):this[n](1)}}),Zn(["pluck","where"],function(e,t){var n=t?"filter":"map",r=t?qr:Ja;In.prototype[e]=function(e){return this[n](r(e))}}),In.prototype.compact=function(){return this.filter(qa)},In.prototype.reject=function(e,t){return e=Ui(e,t,1),this.filter(function(t){return!e(t)})},In.prototype.slice=function(e,t){e=e==null?0:+e||0;var n=this;return n.__filtered__&&(e>0||t<0)?new In(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(t=+t||0,n=t<0?n.dropRight(-t):n.take(t-e)),n)},In.prototype.takeRightWhile=function(e,t){return this.reverse().takeWhile(e,t).reverse()},In.prototype.toArray=function(){return this.take(Ln)},_r(In.prototype,function(e,t){var n=/^(?:filter|map|reject)|While$/.test(t),r=/^(?:first|last)$/.test(t),s=Hn[r?"take"+(t=="last"?"Right":""):t];if(!s)return;Hn.prototype[t]=function(){var t=r?[1]:arguments,o=this.__chain__,u=this.__wrapped__,a=!!this.__actions__.length,f=u instanceof In,l=t[0],c=f||mu(u);c&&n&&typeof l=="function"&&l.length!=1&&(f=c=!1);var h=function(e){return r&&o?s(e,1)[0]:s.apply(i,sr([e],t))},p={func:io,args:[h],thisArg:i},d=f&&!a;if(r&&!o)return d?(u=u.clone(),u.__actions__.push(p),e.call(u)):s.call(i,this.value())[0];if(!r&&c){u=d?u:new In(this);var v=e.apply(u,t);return v.__actions__.push(p),new jn(v,o)}return this.thru(h)}}),Zn(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(e){var t=(/^(?:replace|split)$/.test(e)?At:kt)[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:join|pop|replace|shift)$/.test(e);Hn.prototype[e]=function(){var e=arguments;return r&&!this.__chain__?t.apply(this.value(),e):this[n](function(n){return t.apply(n,e)})}}),_r(In.prototype,function(e,t){var n=Hn[t];if(n){var r=n.name,i=Pn[r]||(Pn[r]=[]);i.push({name:t,func:n})}}),Pn[Di(i,u).name]=[{name:"wrapper",func:i}],In.prototype.clone=qn,In.prototype.reverse=Rn,In.prototype.value=Un,Hn.prototype.chain=so,Hn.prototype.commit=oo,Hn.prototype.concat=uo,Hn.prototype.plant=ao,Hn.prototype.reverse=fo,Hn.prototype.toString=lo,Hn.prototype.run=Hn.prototype.toJSON=Hn.prototype.valueOf=Hn.prototype.value=co,Hn.prototype.collect=Hn.prototype.map,Hn.prototype.head=Hn.prototype.first,Hn.prototype.select=Hn.prototype.filter,Hn.prototype.tail=Hn.prototype.rest,Hn}var i,s="3.10.0",o=1,u=2,a=4,f=8,l=16,c=32,h=64,p=128,d=256,v=30,m="...",g=150,y=16,b=200,w=1,E=2,S="Expected a function",x="__lodash_placeholder__",T="[object Arguments]",N="[object Array]",C="[object Boolean]",k="[object Date]",L="[object Error]",A="[object Function]",O="[object Map]",M="[object Number]",_="[object Object]",D="[object RegExp]",P="[object Set]",H="[object String]",B="[object WeakMap]",j="[object ArrayBuffer]",F="[object Float32Array]",I="[object Float64Array]",q="[object Int8Array]",R="[object Int16Array]",U="[object Int32Array]",z="[object Uint8Array]",W="[object Uint8ClampedArray]",X="[object Uint16Array]",V="[object Uint32Array]",$=/\b__p \+= '';/g,J=/\b(__p \+=) '' \+/g,K=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Q=/&(?:amp|lt|gt|quot|#39|#96);/g,G=/[&<>"'`]/g,Y=RegExp(Q.source),Z=RegExp(G.source),et=/<%-([\s\S]+?)%>/g,tt=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,it=/^\w*$/,st=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,ot=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,ut=RegExp(ot.source),at=/[\u0300-\u036f\ufe20-\ufe23]/g,ft=/\\(\\)?/g,lt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ct=/\w*$/,ht=/^0[xX]/,pt=/^\[object .+?Constructor\]$/,dt=/^\d+$/,vt=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,mt=/($^)/,gt=/['\n\r\u2028\u2029\\]/g,yt=function(){var e="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(e+"+(?="+e+t+")|"+e+"?"+t+"|"+e+"+|[0-9]+","g")}(),bt=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],wt=-1,Et={};Et[F]=Et[I]=Et[q]=Et[R]=Et[U]=Et[z]=Et[W]=Et[X]=Et[V]=!0,Et[T]=Et[N]=Et[j]=Et[C]=Et[k]=Et[L]=Et[A]=Et[O]=Et[M]=Et[_]=Et[D]=Et[P]=Et[H]=Et[B]=!1;var St={};St[T]=St[N]=St[j]=St[C]=St[k]=St[F]=St[I]=St[q]=St[R]=St[U]=St[M]=St[_]=St[D]=St[H]=St[z]=St[W]=St[X]=St[V]=!0,St[L]=St[A]=St[O]=St[P]=St[B]=!1;var xt={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},Tt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Nt={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Ct={"function":!0,object:!0},kt={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},At=Ct[typeof r]&&r&&!r.nodeType&&r,Ot=Ct[typeof n]&&n&&!n.nodeType&&n,Mt=At&&Ot&&typeof t=="object"&&t&&t.Object&&t,_t=Ct[typeof self]&&self&&self.Object&&self,Dt=Ct[typeof window]&&window&&window.Object&&window,Pt=Ot&&Ot.exports===At&&At,Ht=Mt||Dt!==(this&&this.window)&&Dt||_t||this,sn=rn();typeof e=="function"&&typeof e.amd=="object"&&e.amd?(Ht._=sn,e(function(){return sn})):At&&Ot?Pt?(Ot.exports=sn)._=sn:At._=sn:Ht._=sn}).call(this)}).call(this,typeof global!="undefined"?global:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[1])(1)}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/GraphData",["dagre"],t):e.graph_GraphData=t(e.dagre)}(this,function(e){function t(){e.graphlib.Graph.call(this,{multigraph:!0,compound:!0}),this.setGraph({}),this.setDefaultNodeLabel(function(){return{}}),this.setDefaultEdgeLabel(function(){return{}})}return t.prototype=Object.create(e.graphlib.Graph.prototype),t.prototype.constructor=t,t.prototype.setData=function(e,t,n,r){var i=this,s={addedVertices:[],addedEdges:[]};for(var o=0;o<e.length;++o){var u=e[o];if(!r||!this.hasNode(u._id))this.setNode(u._id,u),s.addedVertices.push(u)}for(o=0;o<t.length;++o){var a=t[o];if(!r||!this.hasEdge(a._id))this.setEdge(a._sourceVertex._id,a._targetVertex._id,a,a._id),s.addedEdges.push(a)}if(n)for(o=0;o<n.length;++o)this.setParent(n[o].child._id,n[o].parent._id);if(r){var f=t.map(function(e){return e._id});this.filterEdges(function(e){return f.indexOf(e.v+"_"+e.w)<0}).forEach(function(e){});var l=e.map(function(e){return e._id});this.filterNodes(function(e){return l.indexOf(e)<0}).forEach(function(e){try{i.delNode(e)}catch(t){}})}return s},t.prototype.filterEdges=function(e){var t=[];return this.eachEdge(function(n){e(n)&&t.push(n)}),t},t.prototype.filterNodes=function(e){var t=[];return this.eachNode(function(n){e(n)&&t.push(n)}),t},t.prototype.nodeValues=function(){var e=[];return this.nodes().forEach(function(t,n){e.push(this.node(t))},this),e},t.prototype.eachNode=function(e){this.nodes().forEach(function(t,n){e(t,this.node(t))},this)},t.prototype.edgeValues=function(){var e=[];return this.edges().forEach(function(t,n){e.push(this.edge(t))},this),e},t.prototype.eachEdge=function(e){this.edges().forEach(function(t,n){e(t,t.v,t.w,this.edge(t))},this)},t.prototype.getJSON=function(){var t=e.graphlib.json.write(this);return JSON.stringify(t,function(e,t){return e==="value"?t._text&&t._text._text?t._text._text:t._id:t},"  ")},t}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/GraphLayouts",["d3","dagre"],t):e.graph_GraphLayouts=t(e.d3,e.dagre)}(this,function(e,t){function n(e,t,n,r){var i=this;this.pos={};var s=0;r=r||(t<n?t-s:n-s)/2;var o=e.nodeCount(),u=-Math.PI/2,a=2*Math.PI/o;e.eachNode(function(e,t){var n=t.getBBox(!0),s=Math.max(n.width,n.height);i.pos[e]={x:t.fixed?t.x:Math.cos(u)*(r-s),y:t.fixed?t.y:Math.sin(u)*(r-s),width:n.width,height:n.height},u+=a})}function r(e,t,n,r){var i=this;this.pos={},e.eachNode(function(e,t){i.pos[e]={x:t.x,y:t.y,width:t.width,height:t.height}})}function i(t,n,r,i){i=i||{};var s=this;this.pos={},this.vertices=[],this.vertexMap={},t.eachNode(function(e){var n=t.node(e),r=n.getBBox(!0),i={id:e,x:n.pos().x,y:n.pos().y,width:r.width,height:r.height,value:n};s.vertices.push(i),s.vertexMap[e]=i}),this.edges=[],t.eachEdge(function(e,t,n){s.edges.push({source:s.vertexMap[t],target:s.vertexMap[n]})}),this.force=e.layout.force().linkDistance(i.linkDistance).linkStrength(i.linkStrength).friction(i.friction).charge(function(e){var t=e.value.getBBox();return i.charge*Math.max(t.width,t.height)}).chargeDistance(i.chargeDistance).theta(i.theta).gravity(i.gravity).nodes(this.vertices).links(this.edges);if(i.oneShot){this.force.start();var o=t.nodeCount();o=Math.min(o*o,500);for(var u=0;u<o;++u)this.force.tick();this.force.stop()}}function s(e,n,r,i){var s=(new t.graphlib.Graph({multigraph:!0,compound:!0})).setGraph(i).setDefaultNodeLabel(function(){return{}}).setDefaultEdgeLabel(function(){return{}});e.eachNode(function(t){var n=e.node(t),r=n.getBBox();s.setNode(t,{width:r.width,height:r.height})}),e.eachEdge(function(t,n,r){var i=e.edge(t);s.setEdge(n,r,{weight:i.weight()},i._id)}),e.eachNode(function(t){s.setParent(t,e.parent(t))}),this.dagreLayout=t.layout(s);var o=-s.graph().width/2,u=-s.graph().height/2;s.nodes().forEach(function(e){var t=s.node(e);t.x+=o,t.y+=u}),s.edges().forEach(function(e){var t=s.edge(e);for(var n=0;n<t.points.length;++n)t.points[n].x+=o,t.points[n].y+=u}),this.digraph=s}n.prototype.nodePos=function(e){return this.pos[e]},n.prototype.edgePoints=function(e){return[]},r.prototype.nodePos=function(e){return this.pos[e]},r.prototype.edgePoints=function(e){return[]},i.prototype.nodePos=function(e){return this.vertexMap[e]},i.prototype.edgePoints=function(e){return[]},s.prototype.nodePos=function(e){return this.digraph.node(e)},s.prototype.edgePoints=function(e){return this.digraph.edge(e._sourceVertex.id(),e._targetVertex.id(),e._id).points};var o={None:r,Circle:n,ForceDirected:i,Hierarchy:s};return o}),define("css!src/graph/Graph",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/Graph",["d3","../common/SVGWidget","../common/Palette","../api/IGraph","./Vertex","./Edge","./GraphData","./GraphLayouts","../common/Utility","css!./Graph"],t):e.graph_Graph=t(e.d3,e.common_SVGWidget,e.common_Palette,e.api_IGraph,e.graph_Vertex,e.graph_Edge,e.graph_GraphData,e.graph_GraphLayouts,e.common_Utility)}(this,function(e,t,n,r,i,s,o,u,a){function f(){t.call(this),r.call(this),this.graphData=new o,this.highlight={zoom:1.1,opacity:.33,edge:"1.25px"},this._selection=new a.Selection}return f.prototype=Object.create(t.prototype),f.prototype.constructor=f,f.prototype._class+=" graph_Graph",f.prototype.implements(r.prototype),f.prototype.Vertex=i,f.prototype.Edge=s,f.prototype.publish("allowDragging",!0,"boolean","Allow Dragging of Vertices",null,{tags:["Advanced"]}),f.prototype.publish("layout","Circle","set","Default Layout",["Circle","ForceDirected","ForceDirected2","Hierarchy","None"],{tags:["Basic"]}),f.prototype.publish("scale","100%","set","Zoom Level",["all","width","selection","100%","90%","75%","50%","25%","10%"],{tags:["Basic"]}),f.prototype.publish("applyScaleOnLayout",!1,"boolean","Shrink to fit on Layout",null,{tags:["Basic"]}),f.prototype.publish("highlightOnMouseOverVertex",!1,"boolean","Highlight Vertex on Mouse Over",null,{tags:["Basic"]}),f.prototype.publish("highlightOnMouseOverEdge",!1,"boolean","Highlight Edge on Mouse Over",null,{tags:["Basic"]}),f.prototype.publish("transitionDuration",250,"number","Transition Duration",null,{tags:["Intermediate"]}),f.prototype.publish("showEdges",!0,"boolean","Show Edges",null,{tags:["Intermediate"]}),f.prototype.publish("snapToGrid",0,"number","Snap to Grid",null,{tags:["Private"]}),f.prototype.publish("hierarchyRankDirection","TB","set","Direction for Rank Nodes",["TB","BT","LR","RL"],{tags:["Advanced"]}),f.prototype.publish("hierarchyNodeSeparation",50,"number","Number of pixels that separate nodes horizontally in the layout",null,{tags:["Advanced"]}),f.prototype.publish("hierarchyEdgeSeparation",10,"number","Number of pixels that separate edges horizontally in the layout",null,{tags:["Advanced"]}),f.prototype.publish("hierarchyRankSeparation",50,"number","Number of pixels between each rank in the layout",null,{tags:["Advanced"]}),f.prototype.publish("forceDirectedLinkDistance",300,"number","Target distance between linked nodes",null,{tags:["Advanced"]}),f.prototype.publish("forceDirectedLinkStrength",1,"number","Strength (rigidity) of links",null,{tags:["Advanced"]}),f.prototype.publish("forceDirectedFriction",.9,"number","Friction coefficient",null,{tags:["Advanced"]}),f.prototype.publish("forceDirectedCharge",-25,"number","Charge strength ",null,{tags:["Advanced"]}),f.prototype.publish("forceDirectedChargeDistance",1e4,"number","Maximum distance over which charge forces are applied",null,{tags:["Advanced"]}),f.prototype.publish("forceDirectedTheta",.8,"number","Barnes–Hut approximation criterion",null,{tags:["Advanced"]}),f.prototype.publish("forceDirectedGravity",.1,"number","Gravitational strength",null,{tags:["Advanced"]}),f.prototype.getOffsetPos=function(){return{x:0,y:0}},f.prototype.size=function(e){var n=t.prototype.size.apply(this,arguments);return arguments.length&&this._svgZoom&&this._svgZoom.attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height),n},f.prototype.clear=function(){this.data({vertices:[],edges:[],hierarchy:[],merge:!1})},f.prototype.data=function(e){var n=t.prototype.data.apply(this,arguments);if(arguments.length){this.data().merge||(this.graphData=new o,this._renderCount=0);var r=this.graphData.setData(this.data().vertices||[],this.data().edges||[],this.data().hierarchy||[],this.data().merge||!1),i=this;r.addedVertices.forEach(function(e){e.pos({x:+Math.random()*10/2-5,y:+Math.random()*10/2-5})}),r.addedEdges.forEach(function(e){e._sourceMarker&&(e._sourceMarker=i._id+"_"+e._sourceMarker),e._targetMarker&&(e._targetMarker=i._id+"_"+e._targetMarker)});var s={};this.graphData.edgeValues().forEach(function(e){s[e._sourceVertex._id]||(s[e._sourceVertex._id]={}),s[e._sourceVertex._id][e._targetVertex._id]||(s[e._sourceVertex._id][e._targetVertex._id]=0);var t=++s[e._sourceVertex._id][e._targetVertex._id];e.arcDepth(16*t)})}return n},f.prototype.selection=function(e){return arguments.length?(this._selection.set(e),this):this._selection.get()},f.prototype.setZoom=function(e,t,n){this.zoom&&(this.zoom.translate(e),this.zoom.scale(t),this.applyZoom(n))},f.prototype.applyZoom=function(t){e.event&&e.event.sourceEvent&&e.event.sourceEvent.ctrlKey&&(e.event.sourceEvent.type==="wheel"||e.event.sourceEvent.type==="mousewheel"||e.event.sourceEvent.type==="DOMMouseScroll")&&e.event.sourceEvent.wheelDelta&&(this.zoom.translate([this.prevTranslate[0],this.prevTranslate[1]+e.event.sourceEvent.wheelDelta]),this.zoom.scale(this.prevScale)),(t?this.svg.transition().duration(t):this.svg).attr("transform","translate("+this.zoom.translate()+")scale("+this.zoom.scale()+")"),this.prevTranslate=this.zoom.translate(),this.prevScale!==this.zoom.scale()&&(this._fixIEMarkers(),this.prevScale=this.zoom.scale()),this.brush.x(e.scale.identity().domain([(-this.prevTranslate[0]-this._size.width/2)*1/this.zoom.scale(),(-this.prevTranslate[0]+this._size.width/2)*1/this.zoom.scale()])),this.brush.y(e.scale.identity().domain([(-this.prevTranslate[1]-this._size.height/2)*1/this.zoom.scale(),(-this.prevTranslate[1]+this._size.height/2)*1/this.zoom.scale()]))},f.prototype.enter=function(n,r){function s(t){if(i.allowDragging()){e.event.sourceEvent.stopPropagation(),i._dragging=!0;if(i.forceLayout){var n=i.forceLayout.vertexMap[t.id()];n.fixed=!0}i.svgMarkerGlitch&&i.graphData.nodeEdges(t.id()).forEach(function(e){var t=i.graphData.edge(e);i._pushMarkers(t.element(),t)})}}function o(t){if(i.allowDragging()){e.event.sourceEvent.stopPropagation(),t.move({x:e.event.x,y:e.event.y});if(i.forceLayout){var n=i.forceLayout.vertexMap[t.id()];n.fixed=!0,n.x=n.px=e.event.x,n.y=n.py=e.event.y}i.refreshIncidentEdges(t,!0)}}function u(t){if(i.allowDragging()){e.event.sourceEvent.stopPropagation(),i._dragging=!1;if(i.snapToGrid()){var n=t.calcSnap(i.snapToGrid());t.move(n[0]),i.refreshIncidentEdges(t,!0)}if(i.forceLayout){var r=i.forceLayout.vertexMap[t.id()];r.fixed=!1}i.svgMarkerGlitch&&i.graphData.nodeEdges(t.id()).forEach(function(e){var t=i.graphData.edge(e);i._popMarkers(t.element(),t)})}}t.prototype.enter.apply(this,arguments);var i=this;this.prevTranslate=[0,0],this.prevScale=1,this.zoom=e.behavior.zoom().scaleExtent([.01,4]).on("zoomstart",function(t){i.prevTranslate=i.zoom.translate(),i.prevScale=i.zoom.scale(),e.event.sourceEvent&&e.event.sourceEvent.shiftKey&&e.event.sourceEvent.ctrlKey?i._zoomMode="selection":e.event.sourceEvent&&e.event.sourceEvent.shiftKey?(i._zoomMode="selection",i._selection.clear()):i._zoomMode="zoom";switch(i._zoomMode){case"selection":r.select(".extent").style("visibility",null);break;default:r.select(".extent").style("visibility","hidden")}}).on("zoomend",function(e){switch(i._zoomMode){case"selection":i.zoom.translate(i.prevTranslate),i.zoom.scale(i.prevScale);break;default:}i._svgBrush.call(i.brush.clear())}).on("zoom",function(e){switch(i._zoomMode){case"selection":break;default:i.applyZoom()}}),this.brush=e.svg.brush().x(e.scale.identity().domain([-i._size.width/2,i._size.width/2])).y(e.scale.identity().domain([-i._size.height/2,i._size.height/2])).on("brushstart",function(e){switch(i._zoomMode){case"selection":break;default:}}).on("brushend",function(t){switch(i._zoomMode){case"selection":var n=e.event.target.extent();i.svgV.selectAll(".graphVertex").select("*").each(function(e){n[0][0]<=e.x()&&e.x()<n[1][0]&&n[0][1]<=e.y()&&e.y()<n[1][1]&&i._selection.append(e)}),i.graph_selection(i.selection());break;default:}}).on("brush",function(){switch(i._zoomMode){case"selection":var t=i.zoom.translate();console.log(t[0]);var n=e.event.target.extent();i.svgV.selectAll(".graphVertex").select("*").classed("selected",function(e){return i._selection.isSelected(e)||n[0][0]<=e.x()&&e.x()<n[1][0]&&n[0][1]<=e.y()&&e.y()<n[1][1]});break;default:}}),this.drag=e.behavior.drag().origin(function(e){return e.pos()}).on("dragstart",s).on("dragend",u).on("drag",o),this._svgZoom=r.append("rect").attr("class","zoom").attr("x",-this._size.width/2).attr("y",-this._size.height/2).attr("width",this._size.width).attr("height",this._size.height),this.defs=r.append("defs"),this.addMarkers(),r.call(this.zoom),this.svg=r.append("g"),this._svgBrush=this.svg.append("g").attr("class","selectionBrush").call(this.brush),this._svgBrush.select(".background").style("cursor",null),i._svgBrush.call(i.brush.clear()),this.svgC=this.svg.append("g").attr("id",this._id+"C"),this.svgE=this.svg.append("g").attr("id",this._id+"E"),this.svgV=this.svg.append("g").attr("id",this._id+"V")},f.prototype.getBounds=function(e,t){var n=[[null,null],[null,null]];return e.forEach(function(e){var r=t?t.nodePos(e._id):{x:e.x(),y:e.y(),width:e.width(),height:e.height()},i=r.x-r.width/2,s=r.x+r.width/2,o=r.y-r.height/2,u=r.y+r.height/2;if(n[0][0]===null||n[0][0]>i)n[0][0]=i;if(n[0][1]===null||n[0][1]>o)n[0][1]=o;if(n[1][0]===null||n[1][0]<s)n[1][0]=s;if(n[1][1]===null||n[1][1]<u)n[1][1]=u}),n},f.prototype.getVertexBounds=function(e){return this.getBounds(this.graphData.nodeValues(),e)},f.prototype.getSelectionBounds=function(e){return this.getBounds(this._selection.get(),e)},f.prototype.shrinkToFit=function(e,t){var n=this.width(),r=this.height(),i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=(e[0][0]+e[1][0])/2,u=(e[0][1]+e[1][1])/2,a=1/Math.max(i/n,s/r);a>1&&(a=1);var f=[-a*o,-a*u];this.setZoom(f,a,t)},f.prototype._origScale=f.prototype.scale,f.prototype.scale=function(e,t){var n=f.prototype._origScale.apply(this,arguments);return arguments.length&&this.zoomTo(e,t),n},f.prototype.zoomTo=function(e,t){switch(e){case"all":this.shrinkToFit(this.getVertexBounds(),t);break;case"width":var n=this.getVertexBounds();n[0][1]=0,n[1][1]=0,this.shrinkToFit(n,t);break;case"selection":this.shrinkToFit(this._selection.isEmpty()?this.getVertexBounds():this.getSelectionBounds(),t);break;default:var r=parseInt(e);if(isNaN(r)||r<=0||r>200)r=100;this.zoom.scale(r/100),this.applyZoom(t)}},f.prototype.centerOn=function(e,t){var n=(e[0][0]+e[1][0])/2,r=(e[0][1]+e[1][1])/2,i=[n,r];this.setZoom(i,1,t)},f.prototype._origLayout=f.prototype.layout,f.prototype.layout=function(e,t){var n=f.prototype._origLayout.apply(this,arguments);if(arguments.length&&this._renderCount){this.forceLayout&&(this.forceLayout.force.stop(),this.forceLayout=null);var r=this,i=this.getLayoutEngine();if(this.layout()==="ForceDirected2")this.forceLayout=i,this.forceLayout.force.on("tick",function(e){i.vertices.forEach(function(e){var t=r.graphData.node(e.id);e.fixed?(e.x=e.px,e.y=e.py):(e.px=e.x,e.py=e.y,t.move({x:e.x,y:e.y}))}),r.graphData.edgeValues().forEach(function(e){e.points([],!1,!1)});if(r.applyScaleOnLayout()){var t=r.getVertexBounds(i);r.shrinkToFit(t)}}),this.forceLayout.force.start();else if(i){this.forceLayout=null,r._dragging=!0,r.graphData.nodeValues().forEach(function(e){var n=i.nodePos(e._id);e.move({x:n.x,y:n.y},t),n.width&&n.height&&!e.width()&&!e.height()&&e.width(n.width).height(n.height).render()}),r.graphData.edgeValues().forEach(function(e){var n=i.edgePoints(e);e.points(n,t)});if(r.applyScaleOnLayout()){var s=r.getVertexBounds(i);r.shrinkToFit(s,t)}this._fixIEMarkers(),setTimeout(function(){r._dragging=!1},t?t+50:50)}}return n},f.prototype.update=function(n,r){function o(e){e.target(this).render(),e.element().call(i.drag),e.dispatch&&(e.dispatch.on("sizestart",function(e,t){e.allowResize(i.allowDragging()),i.allowDragging()&&(i._dragging=!0)}),e.dispatch.on("size",function(e,t){i.refreshIncidentEdges(e,!1)}),e.dispatch.on("sizeend",function(e,t){i._dragging=!1;if(i.snapToGrid()){var n=e.calcSnap(i.snapToGrid());e.pos(n[0]).size(n[1]).render(),i.refreshIncidentEdges(e,!1)}}))}function a(e){e.target(this).render()}function f(e){e.render()}function l(e){e.render()}t.prototype.update.apply(this,arguments);var i=this,s=this.svgV.selectAll("#"+this._id+"V > .graphVertex").data(this.graphData.nodeValues(),function(e){return e.id()});s.enter().append("g").attr("class","graphVertex").style("opacity",1e-6).on("click.selectionBag",function(t){i._selection.click(t,e.event)}).on("click",function(t){i.vertex_click(t,e.event)}).on("dblclick",function(t){i.vertex_dblclick(t,e.event)}).on("mouseover",function(t){if(i._dragging)return;i.vertex_mouseover(e.select(this),t)}).on("mouseout",function(t){if(i._dragging)return;i.vertex_mouseout(e.select(this),t)}).each(o).transition().duration(750).style("opacity",1);var u=this.svgE.selectAll("#"+this._id+"E > .graphEdge").data(this.showEdges()?this.graphData.edgeValues():[],function(e){return e.id()});u.enter().append("g").attr("class","graphEdge").style("opacity",1e-6).on("click.selectionBag",function(t){i._selection.click(t,e.event)}).on("click",function(e){i.edge_click(e)}).on("mouseover",function(t){if(i._dragging)return;i.edge_mouseover(e.select(this),t)}).on("mouseout",function(t){if(i._dragging)return;i.edge_mouseout(e.select(this),t)}).each(a).transition().duration(750).style("opacity",1),s.each(f),u.each(l),s.exit().each(function(e){e.target(null)}).remove(),u.exit().each(function(e){e.target(null)}).remove(),this._renderCount||(this._renderCount++,this.setZoom([0,0],1),this.layout(this.layout()))},f.prototype.getLayoutEngine=function(){switch(this.layout()){case"Circle":return new u.Circle(this.graphData,this._size.width,this._size.height);case"ForceDirected":return new u.ForceDirected(this.graphData,this._size.width,this._size.height,{oneShot:!0,linkDistance:this.forceDirectedLinkDistance(),linkStrength:this.forceDirectedLinkStrength(),friction:this.forceDirectedFriction(),charge:this.forceDirectedCharge(),chargeDistance:this.forceDirectedChargeDistance(),theta:this.forceDirectedTheta(),gravity:this.forceDirectedGravity()});case"ForceDirected2":return new u.ForceDirected(this.graphData,this._size.width,this._size.height,{linkDistance:this.forceDirectedLinkDistance(),linkStrength:this.forceDirectedLinkStrength(),friction:this.forceDirectedFriction(),charge:this.forceDirectedCharge(),chargeDistance:this.forceDirectedChargeDistance(),theta:this.forceDirectedTheta(),gravity:this.forceDirectedGravity()});case"Hierarchy":return new u.Hierarchy(this.graphData,this._size.width,this._size.height,{rankdir:this.hierarchyRankDirection(),nodesep:this.hierarchyNodeSeparation(),edgesep:this.hierarchyEdgeSeparation(),ranksep:this.hierarchyRankSeparation()})}return null},f.prototype.getNeighborMap=function(e){var t={},n={};if(e){var r=this.graphData.nodeEdges(e.id());for(var i=0;i<r.length;++i){var s=this.graphData.edge(r[i]);n[s.id()]=s,s._sourceVertex.id()!==e.id()&&(t[s._sourceVertex.id()]=s._sourceVertex),s._targetVertex.id()!==e.id()&&(t[s._targetVertex.id()]=s._targetVertex)}}return{vertices:t,edges:n}},f.prototype.highlightVerticies=function(e){var t=this,n=this.svgV.selectAll(".graphVertex");return n.transition().duration(this.transitionDuration()).each("end",function(t){e&&e[t.id()]&&t._parentElement.node()&&t._parentElement.node().parentNode&&t._parentElement.node().parentNode.appendChild(t._parentElement.node())}).style("opacity",function(n){return!e||e[n.id()]?1:t.highlight.opacity}),this},f.prototype.highlightEdges=function(e){var t=this,n=this.svgE.selectAll(".graphEdge");return n.style("stroke-width",function(n){return e&&e[n.id()]?t.highlight.edge:"1px"}).transition().duration(this.transitionDuration()).style("opacity",function(n){return!e||e[n.id()]?1:t.highlight.opacity}),this},f.prototype.highlightVertex=function(e,t){if(this.highlightOnMouseOverVertex())if(t){var n=this.getNeighborMap(t);n.vertices[t.id()]=t,this.highlightVerticies(n.vertices),this.highlightEdges(n.edges)}else this.highlightVerticies(null),this.highlightEdges(null)},f.prototype.highlightEdge=function(e,t){if(this.highlightOnMouseOverEdge())if(t){var n={};n[t._sourceVertex.id()]=t._sourceVertex,n[t._targetVertex.id()]=t._targetVertex;var r={};r[t.id()]=t,this.highlightVerticies(n),this.highlightEdges(r)}else this.highlightVerticies(null),this.highlightEdges(null)},f.prototype.refreshIncidentEdges=function(e,t){var n=this;this.graphData.nodeEdges(e.id()).forEach(function(e){var r=n.graphData.edge(e);r.points([],!1,t)})},f.prototype.graph_selection=function(e){},f.prototype.vertex_click=function(e){e._parentElement.node().parentNode.appendChild(e._parentElement.node()),r.prototype.vertex_click.apply(this,arguments)},f.prototype.vertex_dblclick=function(e){},f.prototype.vertex_mouseover=function(e,t){this.highlightVertex(e,t)},f.prototype.vertex_mouseout=function(e,t){this.highlightVertex(null,null)},f.prototype.edge_mouseover=function(e,t){this.highlightEdge(e,t)},f.prototype.edge_mouseout=function(e,t){this.highlightEdge(null,null)},f.prototype.addMarkers=function(e){e&&(this.defs.select("#"+this._id+"_arrowHead").remove(),this.defs.select("#"+this._id+"_circleFoot").remove(),this.defs.select("#"+this._id+"_circleHead").remove()),this.defs.append("marker").attr("class","marker").attr("id",this._id+"_arrowHead").attr("viewBox","0 0 10 10").attr("refX",10).attr("refY",5).attr("markerWidth",8).attr("markerHeight",8).attr("markerUnits","strokeWidth").attr("orient","auto").append("polyline").attr("points","0,0 10,5 0,10 1,5"),this.defs.append("marker").attr("class","marker").attr("id",this._id+"_circleFoot").attr("viewBox","0 0 10 10").attr("refX",1).attr("refY",5).attr("markerWidth",7).attr("markerHeight",7).attr("markerUnits","strokeWidth").attr("orient","auto").append("circle").attr("cx",5).attr("cy",5).attr("r",4),this.defs.append("marker").attr("class","marker").attr("id",this._id+"_circleHead").attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerWidth",7).attr("markerHeight",7).attr("markerUnits","strokeWidth").attr("orient","auto").append("circle").attr("cx",5).attr("cy",5).attr("r",4)},f}),define("css!src/graph/Sankey",[],function(){}),function(e,t){typeof define=="function"&&define.amd?define("src/graph/Sankey",["d3","../common/SVGWidget","../common/Palette","../common/PropertyExt","../common/Utility","d3-sankey","css!./Sankey"],t):e.graph_Sankey=t(e.d3,e.common_SVGWidget,e.common_Palette,e.common_PropertyExt,e.common_Utility,e.d3.sankey)}(this,function(e,t,n,r,i,s){function o(e){r.call(this),this._owner=e}function u(e){t.call(this),this._drawStartPos="origin"}return s=s||e.sankey||window.d3.sankey,o.prototype=Object.create(r.prototype),o.prototype.constructor=o,o.prototype._class+=" graph_Sankey.Column",o.prototype.publish("column",null,"set","Field",function(){return this._owner?this._owner.columns():[]},{optional:!0}),o.prototype.publish("aggrType",null,"set","Aggregation Type",[null,"mean","median","sum","min","max"],{optional:!0,disable:function(e){return!e._owner||e._owner.mappings().indexOf(e)===0}}),o.prototype.publish("aggrColumn",null,"set","Aggregation Field",function(){return this._owner?this._owner.columns():[]},{optional:!0,disable:function(e){return!e._owner||!e.aggrType()||e._owner.mappings().indexOf(e)===0}}),o.prototype.aggregate=function(t){switch(this.aggrType()){case null:case undefined:case"":return t.length;default:var n=this._owner.columns(),r=n.indexOf(this.aggrColumn());return e[this.aggrType()](t,function(e){return+e[r]})}},u.prototype=Object.create(t.prototype),u.prototype.constructor=u,u.prototype._class+=" graph_Sankey",u.prototype.Column=o,u.prototype._palette=n.ordinal("default"),u.prototype.publish("paletteID","default","set","Palette ID",u.prototype._palette.switch()),u.prototype.publish("mappings",[],"propertyArray","Source Columns",null,{autoExpand:o}),u.prototype.publish("vertexWidth",36,"number","Vertex Width"),u.prototype.publish("vertexPadding",40,"number","Vertex Padding"),u.prototype.publish("xAxisMovement",!1,"boolean","Enable x-axis movement"),u.prototype.publish("yAxisMovement",!1,"boolean","Enable y-axis movement"),u.prototype.sankeyData=function(){var e={},t={vertices:[],edges:[]},n=this.mappings().filter(function(e){return e.column()});return n.forEach(function(n,r){var i=this._db.rollupView([n.column()]);i.entries().forEach(function(i){var s=n.column()+":"+r+":"+i.key;e[s]||(t.vertices.push({__id:s,__category:n.column(),name:i.key,origRow:i.values}),e[s]=t.vertices.length-1)},this)},this),n.forEach(function(r,i){if(i<n.length-1){var s=n[i+1],o=this._db.rollupView([r.column(),s.column()]);o.entries().forEach(function(n){var o=r.column()+":"+i+":"+n.key;n.values.forEach(function(n){var r=s.column()+":"+(i+1)+":"+n.key;t.edges.push({__id:o+"_"+r,source:e[o],target:e[r],value:s.aggregate(n.values)})})})}},this),t},u.prototype.enter=function(e,n){t.prototype.enter.apply(this,arguments),this._d3Sankey=new s,this._d3SankeyPath=this._d3Sankey.link(),this._selection=new i.SimpleSelection(n)},u.prototype.update=function(n,r){t.prototype.update.apply(this,arguments),this._palette=this._palette.switch(this.paletteID());var i=this.sankeyData();this._d3Sankey.size([this.width(),this.height()]).nodeWidth(this.vertexWidth()).nodePadding(this.vertexPadding()).nodes(i.vertices).links(i.edges).layout(32);var s=this,o=r.selectAll(".link").data(i.edges);o.enter().append("path").attr("class","link").append("title"),o.attr("d",this._d3SankeyPath).style("stroke-width",function(e){return Math.max(1,e.dy)}).sort(function(e,t){return t.dy-e.dy}),o.select("title").text(function(e){return e.source.name+" → "+e.target.name+"\n"+e.value}),o.exit().remove();var u=r.selectAll(".node").data(i.vertices);u.enter().append("g").attr("class","node").call(this._selection.enter.bind(this._selection)).on("click",function(e,t){s.click(s.rowToObj(e.origRow[0]),"",s._selection.selected(this))}).each(function(t){var n=e.select(this);n.append("rect"),n.append("text")}),u.attr("transform",function(e){return"translate("+e.x+","+e.y+")"}),u.select("rect").attr("height",function(e){return e.dy}).attr("width",this._d3Sankey.nodeWidth()).style("fill",function(e){return s._palette(e.name)}).style("cursor",this.xAxisMovement()||this.yAxisMovement()?null:"default"),u.select("text").attr("x",-6).attr("y",function(e){return e.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(e){return e.name}).filter(function(e){return e.x<s.width()/2}).attr("x",6+this._d3Sankey.nodeWidth()).attr("text-anchor","start"),u.exit().remove()},u.prototype.exit=function(e,n){t.prototype.exit.apply(this,arguments)},u.prototype.click=function(e,t,n){console.log("Click:  "+JSON.stringify(e)+", "+t+","+n)},u}),function(e){var t=document,n="appendChild",r="styleSheet",i=t.createElement("style");i.type="text/css",t.getElementsByTagName("head")[0][n](i),i[r]?i[r].cssText=e:i[n](t.createTextNode(e))}(".graph_Edge{fill:none;stroke:#656565;stroke-width:1px}.graph_Edge .common_TextBox .common_Text{fill:#000;stroke:none}.graph_Edge .common_TextBox .common_Shape{fill:#fff;stroke:none}.graph_Edge.selected{stroke:red!important}.graph_Edge.selected .common_Text{fill:red!important}.graph_Vertex{cursor:move}.graph_Vertex.selected .common_Shape{stroke:red!important}.graph_Graph .marker{fill:#656565;stroke:none;stroke-width:1px}.graph_Graph .zoom{fill:none;pointer-events:all}.graph_Graph .selectionBrush{fill:none;stroke:#a9a9a9}.graph_Sankey .node rect{cursor:move;fill-opacity:.9;shape-rendering:crispEdges;stroke:#a9a9a9}.graph_Sankey .node.selected rect{stroke:red}.graph_Sankey .node.over rect{stroke:orange}.graph_Sankey .node.selected.over rect{stroke:red}.graph_Sankey .node text{pointer-events:none;text-shadow:0 1px 0 #fff}.graph_Sankey .node.selected text{fill:red}.graph_Sankey .node.over text{fill:orange}.graph_Sankey .node.selected.over text{fill:red}.graph_Sankey .link{fill:none;stroke:#000;stroke-opacity:.2}.graph_Sankey .link:hover{stroke-opacity:.5}"),define("hpcc-viz-graph",function(){});